<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>
        MotherNet - DASlab | Harvard University
    </title>
    <link href="../assets/img/logo_small.png" rel="icon" type="image/x-icon" />

    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
    <!-- BOOTSTRAP STYLE SHEET -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet" />

    <!-- CUSTOM STYLES -->
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/faa.css" rel="stylesheet" />

    <!-- Font Awesome -->
    <script src="https://use.fontawesome.com/3227f266ec.js"></script>

    <!-- HTML5 Shiv and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- <style type="text/css">
        html{height: 100%;}
        body.aa{height: auto;
        background: url("../assets/img/queriosity_background.png") no-repeat center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        color: rgba(255, 255, 255, .95)}
    </style> -->

    <style>
        #DNN_1 {
            position: absolute;
            left: 8.22%;
            text-align: center;
            color: rgb(249, 250, 249);
            font-size: 25px;
            border: 2px solid #e7e6e6;
            padding: 2px 4px;
            background: #7091C4;
            width: 240px;
            border-radius: 25px;
            -moz-border-radius: 25px;
        }

        #DNN_2 {
            position: absolute;
            left: 25.22%;
            text-align: center;
            color: rgb(249, 250, 249);
            font-size: 25px;
            border: 2px solid #e7e6e6;
            padding: 2px 4px;
            background: #3FA7DC;
            width: 240px;
            border-radius: 25px;
            -moz-border-radius: 25px;
        }

        #DNN_3 {
            position: absolute;
            left: 42.22%;
            text-align: center;
            color: rgb(249, 250, 249);
            font-size: 25px;
            border: 2px solid #e7e6e6;
            padding: 2px 4px;
            background: #5170A2;
            width: 240px;
            border-radius: 25px;
            -moz-border-radius: 25px;
        }

        #DNN_4 {
            position: absolute;
            left: 59.22%;
            text-align: center;
            color: rgb(249, 250, 249);
            font-size: 25px;
            border: 2px solid #e7e6e6;
            padding: 2px 4px;
            background: #ad46f3;
            width: 240px;
            border-radius: 25px;
            -moz-border-radius: 25px;
        }

        #DNN_5 {
            position: absolute;
            left: 76.22%;
            text-align: center;
            color: rgb(249, 250, 249);
            font-size: 25px;
            border: 2px solid #e7e6e6;
            padding: 2px 4px;
            background: #f845f1;
            width: 240px;
            border-radius: 25px;
            -moz-border-radius: 25px;
        }

        #circle1 {
            position: absolute;
            left: 22%;
            width: 15px;
            height: 15px;
            background: rgb(12, 84, 83);
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #circle2 {
            position: absolute;
            left: 33%;
            width: 15px;
            height: 15px;
            background: #7091C4;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #circle3 {
            position: absolute;
            left: 44%;
            width: 15px;
            height: 15px;
            background: #3FA7DC;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #circle4 {
            position: absolute;
            left: 55%;
            width: 15px;
            height: 15px;
            background: #5170A2;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #circle5 {
            position: absolute;
            left: 66%;
            width: 15px;
            height: 15px;
            background: #ad46f3;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #circle6 {
            position: absolute;
            left: 77%;
            width: 15px;
            height: 15px;
            background: #f845f1;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }

        #netDef1 {
            position: absolute;
            left: 8%;

        }

        #netDef2 {
            position: absolute;
            left: 25%;

        }

        #netDef3 {
            position: absolute;
            left: 42%;

        }

        #netDef4 {
            position: absolute;
            left: 59%;

        }

        #netDef5 {
            position: absolute;
            left: 76%;

        }

        #Increase_Networks {
            position: absolute;
            left: 38.5%;
            width: 163px;
        }

        #Increase_Layers {
            position: absolute;
            left: 50.5%;
            width: 163px;
        }

        #Generate_MN {
            position: absolute;
            left: 42.3%;
        }

        #TrainStart {
            position: absolute;
            left: 44.9%;
        }

        #container1 {
            position: absolute;
            left: 10%;
        }

        #container4 {
            position: absolute;
            right: 15%;
        }

        #testset_acc {
            position: relative;
            left: 0%;
            margin-bottom: 90px;
            width: 1100px;
            font-size: 20px;
        }

        .probsdiv canvas {
            float: left;
        }

        .probsdiv {
            height: 60px;
            width: 180px;
            display: inline-block;
            font-size: 12px;
            box-shadow: 0px 0px 2px 2px #EEE;
            margin: 5px;
            padding: 5px;
            color: black;
        }
    </style>

    <style>
        .axis .domain {
            display: none;
        }
    </style>

    <script src="jquery-1.8.3.min.js"></script>
    <script src="../build/vis.js"></script>
    <script src="../build/util.js"></script>
    <script src="../build/convnet.js"></script>
    <script src="../demo/mnist_labels.js"></script>

    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <!-- <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script> -->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
    <script src="http://echarts.baidu.com/build/dist/echarts.js"></script>


    <script>
        var netIndex = 3;
        var layerIndex = new Array(5);//cuz there are up to 5 child/hatched nets
        for (var i = 0; i < 5; i++) { layerIndex[i] = 6; }
        var neuronIndex = 30;
        var layerLog = new Array(5);//cuz there are up to 5 child/hatched nets
        for (var i = 0; i < 5; i++) { layerLog[i] = 6; }
        function addOne(layerID) {
            var temp = layerID - 1;
            var num = document.getElementById(temp);
            num.value = parseInt(num.value) + 1;
        }
        function minusOne(layerID) {
            var temp = layerID - 1;
            var num = document.getElementById(temp);
            if (num.value > 0) {
                num.value = parseInt(num.value) - 1;
            }
        }

        var layer_defs = new Array();
        var net = new Array();
        var hatched_defs = new Array();
        var hatchedNet = new Array();
        var trainer = new Array();
        var t = new Array();
        var legend = new Array();
        var startHatching = false;
        var Fwd = new Array();
        var STEP = 0;
        var Baseline_EA = 0;
        var MN_EA = 0;
        var trainStart_CN = new Array(5);
        var trainEnd_CN = new Array(5);
        var training_CN = new Array(5);
        var trainStart_MN = 0;
        var trainEnd_MN = 0;
        var training_MN = 0;
        var trainStart_HN = new Array(5);
        var trainEnd_HN = new Array(5);
        var training_HN = new Array(5);
        var Accuracy30_Time = new Array(11);
        for (var i = 0; i < 11; i++) {
            Accuracy30_Time[i] = 0;
        }
        var Accuracy50_Time = new Array(11);
        for (var i = 0; i < 11; i++) {
            Accuracy50_Time[i] = 0;
        }
        var Accuracy70_Time = new Array(11);
        for (var i = 0; i < 11; i++) {
            Accuracy70_Time[i] = 0;
        }
        var Accuracy90_Time = new Array(11);
        for (var i = 0; i < 11; i++) {
            Accuracy90_Time[i] = 0;
        }
        var AccuracyCvg_Time = new Array(11);
        for (var i = 0; i < 11; i++) {
            AccuracyCvg_Time[i] = 0;
        }
        //for(var i = 0; i < 5 ; i++) {trainStart_HN[i] = new Date().getTime();}
        var MN_convergence = false;
        var CN_convergence = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_convergence[i] = false;
        }
        var HN_convergence = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_convergence[i] = false;
        }
        var CN_convergeACC = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_convergeACC[i] = 0;
        }
        var MN_convergeACC = 0;
        var HN_convergeACC = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_convergeACC[i] = 0;
        }
        var CN_accLog = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_accLog[i] = [0, 0, 0, 0, 0];
        }
        var CN_avgacc = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_avgacc[i] = 0;
        }
        var MN_accLog = [0, 0, 0, 0, 0];
        var MN_avgacc = 0;
        var HN_accLog = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_accLog[i] = [0, 0, 0, 0, 0];
        }
        var HN_avgacc = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_avgacc[i] = 0;
        }
        var CN_variance = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_variance[i] = 0;
        }
        var MN_variance = 0;
        var HN_variance = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_variance[i] = 0;
        }
        var CN_Max = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_Max[i] = 0;
        }
        var CN_Min = new Array(5);
        for (var i = 0; i < 5; i++) {
            CN_Min[i] = 99999;
        }
        var MN_Max = 0;
        var MN_Min = 99999;
        var HN_Max = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_Max[i] = 0;
        }
        var HN_Min = new Array(5);
        for (var i = 0; i < 5; i++) {
            HN_Min[i] = 99999;
        }
        var BATCH = 128;
        var StartDraw = false;
        var GenerateMN = false;

        var testMN = false;
        var testHN = new Array(5);
        for (var i = 0; i < 5; i++) {
            testHN[i] = false;
        }

        //initialize MN
        var mother_defs, motherNet;
        mother_defs = [];
        mother_defs.push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });//the mother net needs an input layer by default

        var step_num = 0;
        var maxmin = cnnutil.maxmin;
        var f2t = cnnutil.f2t;
        // ------------------------
        // BEGIN MNIST SPECIFIC STUFF
        // ------------------------
        var classes_txt = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];

        var use_validation_data = true;

        var num_batches = 21; // 20 training batches, 1 test batch
        var num_bg_batches = 21;
        var test_batch = 20;
        var data_img_elts = new Array(num_batches);
        var bg_data_img_elts = new Array(num_bg_batches);
        var img_data = new Array(num_batches);
        var bg_img_data = new Array(num_bg_batches);
        var loaded = new Array(num_batches);
        var loaded_train_batches = [];

        var sample_training_instance = function () {
            // find an unloaded batch
            var bi = Math.floor(Math.random() * loaded_train_batches.length);
            var b = loaded_train_batches[bi];
            var k = Math.floor(Math.random() * 3000); // sample within the batch
            var n = b * 3000 + k;

            // load more batches over time
            if (step_num % 3000 === 0 && step_num > 0) {
                for (var i = 0; i < num_batches; i++) {
                    if (!loaded[i]) {
                        load_data_batch(i);
                        break;
                    }
                }
            }

            // fetch the appropriate row of the training image and reshape into a Vol
            var p = img_data[b].data;
            var x = new convnetjs.Vol(28, 28, 1, 0.0);
            var W = 28 * 28;
            var j = 0;
            for (var i = 0; i < W; i++) {
                var ix = ((W * k) + i) * 4;
                x.w[i] = p[ix] / 255.0;
            }

            var isval = use_validation_data && n % 10 === 0 ? true : false;
            return { x: x, label: labels[n], isval: isval };
        }

        // sample a random testing instance
        var sample_test_instance = function () {

            var b = test_batch;
            var k = Math.floor(Math.random() * 1000);
            var n = b * 3000 + k;

            var p = img_data[b].data;
            var x = new convnetjs.Vol(28, 28, 1, 0.0);
            var W = 28 * 28;
            var j = 0;
            for (var i = 0; i < W; i++) {
                var ix = ((W * k) + i) * 4;
                x.w[i] = p[ix] / 255.0;
            }

            return { x: x, label: labels[n] };
        }

        // int main
        //$(window).load(
        Main = function () {
            layer_defs[0] = [];
            layer_defs[0].push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });
            layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(11).value, activation: 'relu' });
            layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(12).value, activation: 'relu' });
            layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(13).value, activation: 'relu' });
            layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(14).value, activation: 'relu' });
            layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(15).value, activation: 'relu' });
            if (document.getElementById(16) != undefined) {
                layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(16).value, activation: 'relu' });
            }
            if (document.getElementById(17) != undefined) {
                layer_defs[0].push({ type: 'fc', num_neurons: document.getElementById(17).value, activation: 'relu' });
            }
            layer_defs[0].push({ type: 'softmax', num_classes: 10 });

            net[0] = new convnetjs.Net();
            net[0].makeLayers(layer_defs[0]);

            trainer[0] = new convnetjs.Trainer(net[0], { method: 'adadelta', learning_rate: document.getElementById("LR1").value, batch_size: document.getElementById("BS1").value, l2_decay: 0.001 });

            layer_defs[1] = [];
            layer_defs[1].push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });
            layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(21).value, activation: 'relu' });
            layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(22).value, activation: 'relu' });
            layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(23).value, activation: 'relu' });
            layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(24).value, activation: 'relu' });
            layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(25).value, activation: 'relu' });
            if (document.getElementById(26) != undefined) {
                layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(26).value, activation: 'relu' });
            }
            if (document.getElementById(27) != undefined) {
                layer_defs[1].push({ type: 'fc', num_neurons: document.getElementById(27).value, activation: 'relu' });
            }
            layer_defs[1].push({ type: 'softmax', num_classes: 10 });

            net[1] = new convnetjs.Net();
            net[1].makeLayers(layer_defs[1]);

            trainer[1] = new convnetjs.Trainer(net[1], { method: 'adadelta', learning_rate: document.getElementById("LR2").value, batch_size: document.getElementById("BS2").value, l2_decay: 0.001 });

            layer_defs[2] = [];
            layer_defs[2].push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });
            layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(31).value, activation: 'relu' });
            layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(32).value, activation: 'relu' });
            layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(33).value, activation: 'relu' });
            layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(34).value, activation: 'relu' });
            layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(35).value, activation: 'relu' });
            if (document.getElementById(36) != undefined) {
                layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(36).value, activation: 'relu' });
            }
            if (document.getElementById(37) != undefined) {
                layer_defs[2].push({ type: 'fc', num_neurons: document.getElementById(37).value, activation: 'relu' });
            }
            layer_defs[2].push({ type: 'softmax', num_classes: 10 });

            net[2] = new convnetjs.Net();
            net[2].makeLayers(layer_defs[2]);

            trainer[2] = new convnetjs.Trainer(net[2], { method: 'adadelta', learning_rate: document.getElementById("LR3").value, batch_size: document.getElementById("BS3").value, l2_decay: 0.001 });

            if (document.getElementById(41) != undefined) {
                layer_defs[3] = [];
                layer_defs[3].push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });
                layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(41).value, activation: 'relu' });
                layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(42).value, activation: 'relu' });
                layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(43).value, activation: 'relu' });
                layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(44).value, activation: 'relu' });
                layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(45).value, activation: 'relu' });
                if (document.getElementById(46) != undefined) {
                    layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(46).value, activation: 'relu' });
                }
                if (document.getElementById(47) != undefined) {
                    layer_defs[3].push({ type: 'fc', num_neurons: document.getElementById(47).value, activation: 'relu' });
                }
                layer_defs[3].push({ type: 'softmax', num_classes: 10 });

                net[3] = new convnetjs.Net();
                net[3].makeLayers(layer_defs[3]);

                trainer[3] = new convnetjs.Trainer(net[3], { method: 'adadelta', learning_rate: document.getElementById("LR4").value, batch_size: document.getElementById("BS4").value, l2_decay: 0.001 });
            }

            if (document.getElementById(51) != undefined) {
                layer_defs[4] = [];
                layer_defs[4].push({ type: 'input', out_sx: 28, out_sy: 28, out_depth: 1 });
                layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(51).value, activation: 'relu' });
                layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(52).value, activation: 'relu' });
                layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(53).value, activation: 'relu' });
                layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(54).value, activation: 'relu' });
                layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(55).value, activation: 'relu' });
                if (document.getElementById(56) != undefined) {
                    layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(56).value, activation: 'relu' });
                }
                if (document.getElementById(57) != undefined) {
                    layer_defs[4].push({ type: 'fc', num_neurons: document.getElementById(57).value, activation: 'relu' });
                }
                layer_defs[4].push({ type: 'softmax', num_classes: 10 });

                net[4] = new convnetjs.Net();
                net[4].makeLayers(layer_defs[4]);

                trainer[4] = new convnetjs.Trainer(net[4], { method: 'adadelta', learning_rate: document.getElementById("LR5").value, batch_size: document.getElementById("BS5").value, l2_decay: 0.001 });
            }


            for (var i = 0; net[i]; i++) {
                hatched_defs[i] = [];
                hatched_defs[i] = layer_defs[i];
                hatchedNet[i] = new convnetjs.Net();
                hatchedNet[i].makeLayers(hatched_defs[i]);
                if (i === 0) {
                    trainer[i + 6] = new convnetjs.SGDTrainer(hatchedNet[i], { method: 'adadelta', learning_rate: document.getElementById("LR1").value, batch_size: document.getElementById("BS1").value, l2_decay: 0.001 });
                }
                else if (i === 1) {
                    trainer[i + 6] = new convnetjs.SGDTrainer(hatchedNet[i], { method: 'adadelta', learning_rate: document.getElementById("LR2").value, batch_size: document.getElementById("BS2").value, l2_decay: 0.001 });
                }
                else if (i === 2) {
                    trainer[i + 6] = new convnetjs.SGDTrainer(hatchedNet[i], { method: 'adadelta', learning_rate: document.getElementById("LR3").value, batch_size: document.getElementById("BS3").value, l2_decay: 0.001 });
                }
                else if (i === 3) {
                    trainer[i + 6] = new convnetjs.SGDTrainer(hatchedNet[i], { method: 'adadelta', learning_rate: document.getElementById("LR3").value, batch_size: document.getElementById("BS3").value, l2_decay: 0.001 });
                }
                else if (i === 4) {
                    trainer[i + 6] = new convnetjs.SGDTrainer(hatchedNet[i], { method: 'adadelta', learning_rate: document.getElementById("LR3").value, batch_size: document.getElementById("BS3").value, l2_decay: 0.001 });
                }

            }


            // for(var i=0;legend[i];i++){
            //     console.log(legend[i]);
            // }


            //we built mother network here based on layer definitions of each child network
            //we look at all the children networks at all convolutional layers (so we skip Input, pooling and softmax layers)
            //, and add the one with fewest filters into the mother network.
            //find the longest childnet who have the most layers
            var longestLength = 0;
            var temp_neuronNum = 10000;
            for (var n = 0; n < layer_defs.length; n++) {
                if (longestLength < layer_defs[n].length) {
                    longestLength = layer_defs[n].length;
                }
            }
            //loop for all positions but skip the input layer and softmax layer.
            for (var i = 1; i < longestLength - 1; i++) {
                temp_neuronNum = 10000;//hope it's big enough
                //loop for each network
                for (var j = 0; net[j]; j++) {
                    if (layer_defs[j][i].type === 'fc' && layer_defs[j][i].num_neurons < temp_neuronNum && layer_defs[j][i].num_neurons > 0) {
                        temp_neuronNum = layer_defs[j][i].num_neurons;
                    }
                }
                mother_defs.push({ type: 'fc', num_neurons: temp_neuronNum, activation: 'relu' });
            }
            mother_defs.push({ type: 'softmax', num_classes: 10 });
            motherNet = new convnetjs.Net();
            motherNet.makeLayers(mother_defs);//implement it
            trainer[5] = new convnetjs.Trainer(motherNet, { method: 'adadelta', batch_size: BATCH, l2_decay: 0.001 });
            GenerateMN = true;
        }


        function Train() {
            for (var k = 0; k < loaded.length; k++) { loaded[k] = false; }

            load_data_batch(0); // async load train set batch 0 (6 total train batches)
            load_data_batch(test_batch); // async load test set (batch 6)
            // load_bg_data_batch(0);
            // load_bg_data_batch(test_batch);
            // for (var i = 0; i < 5; i++) { trainStart_CN[i] = new Date().getTime(); }
            //trainStart_MN = new Date().getTime();
            start_fun();
            StartDraw = true;
            //bg_start_fun();
        }
        //);

        var start_fun = function () {
            if (loaded[0] && loaded[test_batch]) {
                console.log('starting!');
                setInterval(load_and_step, 0);
            }
            else { setTimeout(start_fun, 200); } // keep checking
            //setInterval(widenNets(motherNet, hatchedNet), 1000); //use Mother Network to update hatched networks every 1 sec
        }
        /*
                //hatched part
                var bg_start_fun = function () {
                    if (loaded[test_batch]) {
                        console.log('BG starting!');
                        setInterval(bg_load_and_step, 100);
                    }
                    else { setTimeout(bg_start_fun, 200); }
                }
        */
        var load_data_batch = function (batch_num) {
            // Load the dataset with JS in background
            data_img_elts[batch_num] = new Image();
            var data_img_elt = data_img_elts[batch_num];
            data_img_elt.onload = function () {
                var data_canvas = document.createElement('canvas');
                data_canvas.width = data_img_elt.width;
                data_canvas.height = data_img_elt.height;
                var data_ctx = data_canvas.getContext("2d");
                data_ctx.drawImage(data_img_elt, 0, 0); // copy it over... bit wasteful :(
                img_data[batch_num] = data_ctx.getImageData(0, 0, data_canvas.width, data_canvas.height);
                loaded[batch_num] = true;
                if (batch_num < 20) { loaded_train_batches.push(batch_num); }
                console.log('finished loading data batch ' + batch_num);
            };
            data_img_elt.src = "mnist_batch_" + batch_num + ".png";
        }

        // var load_bg_data_batch = function (batch_num) {
        //     // Load the dataset with JS in background
        //     bg_data_img_elts[batch_num] = new Image();
        //     var bg_data_img_elt = bg_data_img_elts[batch_num];
        //     bg_data_img_elt.onload = function () {
        //         var bg_data_canvas = document.createElement('canvas');
        //         bg_data_canvas.width = bg_data_img_elt.width;
        //         bg_data_canvas.height = bg_data_img_elt.height;
        //         var bg_data_ctx = bg_data_canvas.getContext("2d");
        //         bg_data_ctx.drawImage(bg_data_img_elt, 0, 0); // copy it over... bit wasteful :(
        //         bg_img_data[batch_num] = bg_data_ctx.getImageData(0, 0, bg_data_canvas.width, bg_data_canvas.height);
        //         console.log('finished loading bagging data batch ' + batch_num);
        //     };
        //     bg_data_img_elt.src = "mnist_batch_" + batch_num + ".png";
        // }


        // ------------------------
        // END MNIST SPECIFIC STUFF
        // ------------------------

        // loads a training image and trains on it with the Children Networks and Mother Network
        var paused = false;
        var embed_samples = [];
        var embed_imgs = [];
        var load_and_step = function () {
            if (paused) return;
            var sample = sample_training_instance();
            step(sample); // process this image
        }
        // the hatchedNet part
        var embed_bg_samples = [];
        var embed_bg_imgs = [];
        // var bg_load_and_step = function () {
        //     if (paused) return;

        //     if (embed_bg_samples.length === 0) {
        //         for (var k = 0; k < 200; k++) {
        //             var s = sample_bg_training_instance();
        //             embed_bg_samples.push(s);
        //             var I = render_act(s.x);
        //             embed_bg_imgs.push(I);
        //         }
        //     }
        //     var sample = sample_bg_training_instance();
        //     bg_step(sample);
        // }


        var draw_activations = function (elt, A, scale, grads) {

            var s = scale || 2; // scale
            var draw_grads = false;
            if (typeof (grads) !== 'undefined') draw_grads = grads;

            // get max and min activation to scale the maps automatically
            var w = draw_grads ? A.dw : A.w;
            var mm = maxmin(w);

            // create the canvas elements, draw and add to DOM
            for (var d = 0; d < A.depth; d++) {

                var canv = document.createElement('canvas');
                canv.className = 'actmap';
                var W = A.sx * s;
                var H = A.sy * s;
                canv.width = W;
                canv.height = H;
                var ctx = canv.getContext('2d');
                var g = ctx.createImageData(W, H);

                for (var x = 0; x < A.sx; x++) {
                    for (var y = 0; y < A.sy; y++) {
                        if (draw_grads) {
                            var dval = Math.floor((A.get_grad(x, y, d) - mm.minv) / mm.dv * 255);
                        } else {
                            var dval = Math.floor((A.get(x, y, d) - mm.minv) / mm.dv * 255);
                        }
                        for (var dx = 0; dx < s; dx++) {
                            for (var dy = 0; dy < s; dy++) {
                                var pp = ((W * (y * s + dy)) + (dx + x * s)) * 4;
                                for (var i = 0; i < 3; i++) { g.data[pp + i] = dval; } // rgb
                                g.data[pp + 3] = 255; // alpha channel
                            }
                        }
                    }
                }
                ctx.putImageData(g, 0, 0);
                elt.appendChild(canv);
            }
        }



        // evaluate current network on test set
        // var test_predict1 = function (Net, HN_Index) {
        //     var t = 'Ensemble size ' + HN_Index;
        //     document.getElementById('testset_acc').appendChild(document.createTextNode(t));

        //     var num_classes = Net.layers[Net.layers.length - 1].out_depth;

        //     //document.getElementById('testset_acc').innerHTML = '';
        //     // grab a random test image
        //     for (num = 0; num < 5; num++) {
        //         var sample = sample_test_instance();
        //         var y = sample.label;  // ground truth label

        //         // forward prop it through the network
        //         var aavg = new convnetjs.Vol(1, 1, num_classes, 0.0);
        //         // ensures we always have a list, regardless if above returns single item or list
        //         var xs = [].concat(sample.x);
        //         var n = xs.length;

        //         for (var i = 0; i < n; i++) {
        //             var a = Net.forward(xs[i]);
        //             aavg.addFrom(a);
        //         }
        //         var preds = [];
        //         for (var k = 0; k < aavg.w.length; k++) { preds.push({ k: k, p: aavg.w[k] }); }
        //         preds.sort(function (a, b) { return a.p < b.p ? 1 : -1; });

        //         var div = document.createElement('div');
        //         div.className = 'testdiv';

        //         // draw the image into a canvas
        //         draw_activations(div, xs[0], 2); // draw Vol into canv

        //         // add predictions
        //         var probsdiv = document.createElement('div');
        //         div.className = 'probsdiv';
        //         var t = '';
        //         for (var k = 0; k < 3; k++) {
        //             var col = preds[k].k === y ? 'rgb(85,187,85)' : 'rgb(187,85,85)';
        //             t += '<div class=\"pp\" style=\"width:' + Math.floor(preds[k].p / n * 100) + 'px; margin-left: 60px; background-color:' + col + ';\">' + classes_txt[preds[k].k] + '</div>'
        //         }
        //         probsdiv.innerHTML = t;
        //         div.appendChild(probsdiv);

        //         // add it into DOM
        //         $("#testset_acc").append(div).fadeIn(1000);
        //     }
        // }


        var test_predict = function (HN_Index) {
            var text = 'Ensemble size ' + HN_Index;
            document.getElementById('testset_acc').appendChild(document.createTextNode(text));

            var num_classes = 10;

            //document.getElementById('testset_acc').innerHTML = '';
            // grab a random test image
            for (num = 0; num < 5; num++) {
                var sample = sample_test_instance();
                var y = sample.label;  // ground truth label

                // forward prop it through the network
                var aavg = new Array(HN_Index);
                for(var i=0;i<HN_Index;i++){
                    aavg[i] = new convnetjs.Vol(1, 1, num_classes, 0.0);
                }
                
                // ensures we always have a list, regardless if above returns single item or list
                var xs = [].concat(sample.x);
                var n = xs.length;

                for (var i = 0; i < n; i++) {
                    var a = new Array(HN_Index);
                    for(var j=0;j<HN_Index;j++){
                        a[j] = hatchedNet[j].forward(xs[i]);
                        aavg[j].addFrom(a[j]);
                    }
                }
                var preds = new Array(HN_Index);
                for(var i=0;i<HN_Index;i++){
                    preds[i]=[];
                    for (var k = 0; k < aavg[i].w.length; k++) { preds[i].push({ k: k, p: aavg[i].w[k] }); }
                }
                var EA = [];
                for(var i=0;i<10;i++){
                    var ACC=0;
                    for(var j=0;j<HN_Index;j++){
                        ACC += preds[j][i].p;
                    }
                    EA.push({k:i, p: ACC/HN_Index});
                }
                EA.sort(function (a, b) { return a.p < b.p ? 1 : -1; });

                var div = document.createElement('div');
                div.className = 'testdiv';

                // draw the image into a canvas
                draw_activations(div, xs[0], 2); // draw Vol into canv

                // add predictions
                var probsdiv = document.createElement('div');
                div.className = 'probsdiv';
                var t = '';
                for (var k = 0; k < 3; k++) {
                    var col = EA[k].k === y ? 'rgb(85,187,85)' : 'rgb(187,85,85)';
                    t += '<div class=\"pp\" style=\"width:' + Math.floor(EA[k].p / n * 100) + 'px; margin-left: 60px; background-color:' + col + ';\">' + classes_txt[EA[k].k] + '</div>'
                }
                probsdiv.innerHTML = t;
                div.appendChild(probsdiv);

                // add it into DOM
                $("#testset_acc").append(div).fadeIn(1000);
            }
        }

        var compute_EA = function (Ensemble_Index) {
            var num_classes = 10;
            var correct_HN=0;
            var correct_DNN=0;
            var total=300

            // grab a random test image
            for (num = 0; num < total; num++) {
                var sample = sample_test_instance();
                var y = sample.label;  // ground truth label

                // forward prop it through the network
                var aavg = new Array(Ensemble_Index);
                for(var i=0;i<Ensemble_Index;i++){
                    aavg[i] = new convnetjs.Vol(1, 1, num_classes, 0.0);
                }
                var aavg_DNN = new Array(Ensemble_Index);
                for(var i=0;i<Ensemble_Index;i++){
                    aavg_DNN[i] = new convnetjs.Vol(1, 1, num_classes, 0.0);
                }
                
                // ensures we always have a list, regardless if above returns single item or list
                var xs = [].concat(sample.x);
                var n = xs.length;

                for (var i = 0; i < n; i++) {
                    var a = new Array(Ensemble_Index);
                    for(var j=0;j<Ensemble_Index;j++){
                        a[j] = hatchedNet[j].forward(xs[i]);
                        aavg[j].addFrom(a[j]);
                    }
                    var a_DNN = new Array(Ensemble_Index);
                    for(var j=0;j<Ensemble_Index;j++){
                        a_DNN[j] = net[j].forward(xs[i]);
                        aavg_DNN[j].addFrom(a_DNN[j]);
                    }
                }
                var preds = new Array(Ensemble_Index);
                for(var i=0;i<Ensemble_Index;i++){
                    preds[i]=[];
                    for (var k = 0; k < aavg[i].w.length; k++) { preds[i].push({ k: k, p: aavg[i].w[k] }); }
                }
                var preds_DNN = new Array(Ensemble_Index);
                for(var i=0;i<Ensemble_Index;i++){
                    preds_DNN[i]=[];
                    for (var k = 0; k < aavg_DNN[i].w.length; k++) { preds_DNN[i].push({ k: k, p: aavg_DNN[i].w[k] }); }
                }
                var EA = [];
                for(var i=0;i<10;i++){
                    var ACC=0;
                    for(var j=0;j<Ensemble_Index;j++){
                        ACC += preds[j][i].p;
                    }
                    EA.push({k:i, p: ACC/Ensemble_Index});
                }
                EA.sort(function (a, b) { return a.p < b.p ? 1 : -1; });

                if(EA[0].k === y){
                    correct_HN++;
                }

                var EA_DNN = [];
                for(var i=0;i<10;i++){
                    var ACC_DNN=0;
                    for(var j=0;j<Ensemble_Index;j++){
                        ACC_DNN += preds[j][i].p;
                    }
                    EA_DNN.push({k:i, p: ACC_DNN/Ensemble_Index});
                }
                EA_DNN.sort(function (a, b) { return a.p < b.p ? 1 : -1; });

                if(EA_DNN[0].k === y){
                    correct_DNN++;
                }
            }

            return [correct_HN/total,correct_DNN/total];
        }




        //var lossGraph = new cnnvis.MultiGraph(legend, );
        var xLossWindow = new Array();
        var wLossWindow = new Array();
        var trainAccWindow = new Array();
        var valAccWindow = new Array();
        var testAccWindow = new Array();
        var MNtempAcc = 0;//log the temporary accuracy of MN every 500 steps
        for (var i = 0; i < 5; i++) {
            xLossWindow[i] = new cnnutil.Window(100);
            wLossWindow[i] = new cnnutil.Window(100);
            trainAccWindow[i] = new cnnutil.Window(100);
            valAccWindow[i] = new cnnutil.Window(100);
            testAccWindow[i] = new cnnutil.Window(100);
        }
        //the MN part
        xLossWindow[5] = new cnnutil.Window(100);
        wLossWindow[5] = new cnnutil.Window(100);
        trainAccWindow[5] = new cnnutil.Window(100);
        valAccWindow[5] = new cnnutil.Window(100);
        testAccWindow[5] = new cnnutil.Window(100);
        //temp hatchedNet part
        for (var i = 6; i < 11; i++) {
            xLossWindow[i] = new cnnutil.Window(100);
            wLossWindow[i] = new cnnutil.Window(100);
            trainAccWindow[i] = new cnnutil.Window(100);
            valAccWindow[i] = new cnnutil.Window(100);
            testAccWindow[i] = new cnnutil.Window(100);
        }
        //the HatchedNet part
        var bg_xLossWindow = new Array();
        var bg_wLossWindow = new Array();
        var bg_trainAccWindow = new Array();
        var bg_valAccWindow = new Array();
        var bg_testAccWindow = new Array();
        for (var i = 0; i < 5; i++) {
            bg_xLossWindow[i] = new cnnutil.Window(100);
            bg_wLossWindow[i] = new cnnutil.Window(100);
            bg_trainAccWindow[i] = new cnnutil.Window(100);
            bg_valAccWindow[i] = new cnnutil.Window(100);
            bg_testAccWindow[i] = new cnnutil.Window(100);
        }




        var step = function (sample) {

            var x = sample.x;
            var y = sample.label;
            var stats = new Array();
            var lossx = new Array();
            var lossw = new Array();


            if (sample.isval) {
                var yhat = new Array();
                var val_acc = new Array();
                // use x to build our estimate of validation error
                for (var i = 0; net[i]; i++) {
                    net[i].forward(x);
                    yhat[i] = net[i].getPrediction();
                    val_acc[i] = yhat[i] === y ? 1.0 : 0.0;
                    valAccWindow[i].add(val_acc[i]);
                }
                //the MN part
                motherNet.forward(x);
                yhat[5] = motherNet.getPrediction();
                val_acc[5] = yhat[5] === y ? 1.0 : 0.0;
                valAccWindow[5].add(val_acc[5]);
                //temp hatchedNet part
                for (var i = 0; hatchedNet[i]; i++) {
                    hatchedNet[i].forward(x);
                    yhat[i + 6] = hatchedNet[i].getPrediction();
                    val_acc[i + 6] = yhat[i + 6] === y ? 1.0 : 0.0;
                    valAccWindow[i + 6].add(val_acc[i + 6]);
                }
                return;
            }

            //Now, we train MN method and baseline method at the same time, but we train networks in both of these methods sequentially
            // train on it with networks
            for (var i = 0; net[i]; i++) {
                if (i === 0 && CN_convergence[0] === false) {
                    stats[i] = trainer[i].train(x, y);
                    lossx[i] = stats[i].cost_loss;
                    lossw[i] = stats[i].l2_decay_loss;
                    xLossWindow[i].add(lossx[i]);
                    wLossWindow[i].add(lossw[i]);
                }
                else if (i > 0 && CN_convergence[i - 1] === true && CN_convergence[i] === false) {
                    stats[i] = trainer[i].train(x, y);
                    lossx[i] = stats[i].cost_loss;
                    lossw[i] = stats[i].l2_decay_loss;
                    xLossWindow[i].add(lossx[i]);
                    wLossWindow[i].add(lossw[i]);
                }
            }
            //the MN part
            if (MN_convergence === false) {
                stats[5] = trainer[5].train(x, y);
                lossx[5] = stats[5].cost_loss;
                lossw[5] = stats[5].l2_decay_loss;
                xLossWindow[5].add(lossx[5]);
                wLossWindow[5].add(lossw[5]);
            }
            //temp hatchedNet part
            else if (MN_convergence === true) {
                for (var i = 0; hatchedNet[i]; i++) {
                    if (i === 0 && HN_convergence[0] === false) {
                        stats[i + 6] = trainer[i + 6].train(x, y);
                        lossx[i + 6] = stats[i + 6].cost_loss;
                        lossw[i + 6] = stats[i + 6].l2_decay_loss;
                        xLossWindow[i + 6].add(lossx[i + 6]);
                        wLossWindow[i + 6].add(lossw[i + 6]);
                    }
                    else if (i > 0 && HN_convergence[i - 1] === true && HN_convergence[i] === false) {
                        stats[i + 6] = trainer[i + 6].train(x, y);
                        lossx[i + 6] = stats[i + 6].cost_loss;
                        lossw[i + 6] = stats[i + 6].l2_decay_loss;
                        xLossWindow[i + 6].add(lossx[i + 6]);
                        wLossWindow[i + 6].add(lossw[i + 6]);
                    }
                }
            }


            // keep track of stats such as the average training error and loss
            var yhat = new Array();
            var train_acc = new Array();
            for (var i = 0; net[i]; i++) {
                yhat[i] = net[i].getPrediction();
                train_acc[i] = yhat[i] === y ? 1.0 : 0.0;
                trainAccWindow[i].add(train_acc[i]);
            }
            //the MN part
            yhat[5] = motherNet.getPrediction();
            train_acc[5] = yhat[5] === y ? 1.0 : 0.0;
            trainAccWindow[5].add(train_acc[5]);
            //temp hatchedNet part
            for (var i = 0; hatchedNet[i]; i++) {
                yhat[i + 6] = hatchedNet[i].getPrediction();
                train_acc[i + 6] = yhat[i + 6] === y ? 1.0 : 0.0;
                trainAccWindow[i + 6].add(train_acc[i + 6]);
            }


            //compute the ensemble averaging accuracy
            Baseline_EA = 0;
            if ((CN_convergence[2] === true && document.getElementById(41) === null) || (document.getElementById(41) != null && document.getElementById(51) === null && CN_convergence[3] === true) || (document.getElementById(51) != null && CN_convergence[4] === true)) {
                for (var i = 0; net[i]; i++) {
                    Baseline_EA += CN_convergeACC[i];
                }
                Baseline_EA /= net.length;
            }
            MN_EA = 0;
            if ((HN_convergence[2] === true && document.getElementById(41) === null) || (document.getElementById(41) != null && document.getElementById(51) === null && HN_convergence[3] === true) || (document.getElementById(51) != null && HN_convergence[4] === true)) {
                for (var i = 0; hatchedNet[i]; i++) {
                    MN_EA += HN_convergeACC[i];
                }
                MN_EA /= hatchedNet.length;
            }


            for (var i = 0; net[i]; i++) {
                CN_accLog[i][STEP % 5] = trainAccWindow[i].get_average();
            }
            MN_accLog[STEP % 5] = trainAccWindow[5].get_average();
            for (var i = 0; hatchedNet[i]; i++) {
                HN_accLog[i][STEP % 5] = trainAccWindow[i + 6].get_average();
            }
            for (var i = 0; net[i]; i++) {
                for (var j = 0; j < 5; j++) {
                    if (CN_accLog[i][j] > CN_Max[i]) {
                        CN_Max[i] = CN_accLog[i][j];
                    }
                    if (CN_accLog[i][j] < CN_Min[i]) {
                        CN_Min[i] = CN_accLog[i][j];
                    }
                }
            }
            for (var j = 0; j < 5; j++) {
                if (MN_accLog[j] > MN_Max) {
                    MN_Max = MN_accLog[j];
                }
                if (MN_accLog[j] < MN_Min) {
                    MN_Min = MN_accLog[j];
                }
            }
            for (var i = 0; hatchedNet[i]; i++) {
                for (var j = 0; j < 5; j++) {
                    if (HN_accLog[i][j] > HN_Max[i]) {
                        HN_Max[i] = HN_accLog[i][j];
                    }
                    if (HN_accLog[i][j] < HN_Min[i]) {
                        HN_Min[i] = HN_accLog[i][j];
                    }
                }
            }
            for (var i = 0; net[i]; i++) {
                for (var n = 0; n < 5; n++) {
                    CN_avgacc[i] += CN_accLog[i][n];
                }
                CN_avgacc[i] /= 5;
            }
            for (var n = 0; n < 5; n++) {
                MN_avgacc += MN_accLog[n];
            }
            MN_avgacc /= 5;
            for (var i = 0; hatchedNet[i]; i++) {
                for (var n = 0; n < 5; n++) {
                    HN_avgacc[i] += HN_accLog[i][n];
                }
                HN_avgacc[i] /= 5;
            }
            for (var i = 0; net[i]; i++) {
                for (var j = 0; j < 5; j++) {
                    if (CN_accLog[i][j] - CN_avgacc[i] > 0) {
                        CN_variance[i] += (CN_accLog[i][j] - CN_avgacc[i]);
                    }
                    else {
                        CN_variance[i] -= (CN_accLog[i][j] - CN_avgacc[i]);
                    }
                }
                CN_variance[i] /= 5;
                //console.log(CN_variance);
            }
            for (var i = 0; i < 5; i++) {
                if (MN_accLog[i] - MN_avgacc > 0) {
                    MN_variance += (MN_accLog[i] - MN_avgacc);
                }
                else {
                    MN_variance -= (MN_accLog[i] - MN_avgacc);
                }
            }
            MN_variance /= 5;
            for (var i = 0; hatchedNet[i]; i++) {
                for (var j = 0; j < 5; j++) {
                    if (HN_accLog[i][j] - HN_avgacc[i] > 0) {
                        HN_variance[i] += (HN_accLog[i][j] - HN_avgacc[i]);
                    }
                    else {
                        HN_variance[i] -= (HN_accLog[i][j] - HN_avgacc[i]);
                    }
                }
                HN_variance[i] /= 5;
            }


            //judge the convergence
            for (var i = 0; net[i]; i++) {
                if (CN_Max[i] - CN_Min[i] < 0.93 && trainAccWindow[i].get_average() > 0.91 && CN_convergence[i] === false) {
                    CN_convergence[i] = true;
                    CN_convergeACC[i] = trainAccWindow[i].get_average();
                }
            }
            if (MN_Max - MN_Min < 0.93 && trainAccWindow[5].get_average() > 0.91 && MN_convergence === false) {
                MN_convergence = true;
                widenNets(motherNet, hatchedNet);
                MN_convergeACC = trainAccWindow[5].get_average();
            }
            for (var i = 0; hatchedNet[i]; i++) {
                if (HN_Max[i] - HN_Min[i] < 0.93 && trainAccWindow[i + 6].get_average() > 0.91 && HN_convergence[i] === false) {
                    HN_convergence[i] = true;
                    HN_convergeACC[i] = trainAccWindow[i + 6].get_average();
                }
            }
            //trainAccWindow[i].get_average() > 0.91 &&
            //trainAccWindow[5].get_average() > 0.91 &&
            //trainAccWindow[i + 6].get_average() > 0.91 &&


            if (HN_convergence[0] === true && HN_convergence[1] === false && testHN[0] === false) {
                test_predict(1);
                testHN[0] = true;
            }
            else if (HN_convergence[1] === true && HN_convergence[2] === false && testHN[1] === false) {
                test_predict(2);
                testHN[1] = true;
            }
            else if (HN_convergence[2] === true && testHN[2] === false) {
                test_predict(3);
                testHN[2] = true;
            }
            else if (document.getElementById(41) != null && HN_convergence[3] === true && testHN[3] === false) {
                test_predict(4);
                testHN[3] = true;
            }
            else if (document.getElementById(51) != null && HN_convergence[4] === true && testHN[4] === false) {
                test_predict(5);
                testHN[4] = true;
            }


            step_num++;
            STEP = step_num;
        }




        //widening function
        function widenNets(motherNet, hatchedNet) {
            // console.log(motherNet.layers[3].filters);
            // for (var i = 0; hatchedNet[i]; i++) {
            //     console.log(hatchedNet[i].layers[3].filters);
            // }
            //For the original part in MN, just copy them
            for (var l = 1; l < motherNet.layers.length - 3; l++) { //loop by each hidden fc layer in MN
                if (motherNet.layers[l].layer_type === 'fc') {
                    for (var f = 0; f < motherNet.layers[l].filters.length; f++) { //loop by each "filter" in a certain fc layer, "filter" in fc net means neuron
                        for (var i = 0; i < motherNet.layers[l].filters[f].w.length; i++) { //loop by each weight in a certain "filter"
                            for (var j = 0; hatchedNet[j]; j++) { //copy the weight to every hatchedNet
                                hatchedNet[j].layers[l].filters[f].w[i] = motherNet.layers[l].filters[f].w[i];
                            }
                        }
                    }
                }
            }
            //For the widened part, use the random select
            for (var h = 0; hatchedNet[h]; h++) { //widen each hatchedNet one by one
                for (var l = 1; l < motherNet.layers.length - 3; l++) { //loop by each fc layer in MN except for the last one
                    if (motherNet.layers[l].layer_type === 'fc') {
                        var rdmSlct = 0;
                        var copyCount = new Array(motherNet.layers[l].filters.length), i = copyCount.length; //count how many times has a filter in a certain layer of MN been copied
                        while (i--) { copyCount[i] = 0; } //initialize them with 0
                        var copyPosition = new Array(motherNet.layers[l].filters.length); //log the position in hatchedNet which copied the a certain filter of MN
                        for (var j = 0; j < copyPosition.length; j++) { //initialize them with 0
                            copyPosition[j] = new Array(hatchedNet[h].layers[l].filters.length - motherNet.layers[l].filters.length);
                            for (var k = 0; k < copyPosition[j].length; k++) {
                                copyPosition[j][k] = 0;
                            }
                        }
                        if (motherNet.layers[l].filters.length < hatchedNet[h].layers[l].filters.length) {
                            for (var f = motherNet.layers[l].filters.length; f < hatchedNet[h].layers[l].filters.length; f++) { //build the widened part in a certain layer
                                //console.log(f);
                                rdmSlct = randomFrom(0, motherNet.layers[l].filters.length); //randomly select a filter in the layer l of MN
                                //console.log(copyPosition[rdmSlct][f - motherNet.layers[l].filters.length]+','+rdmSlct+','+(f - motherNet.layers[l].filters.length));
                                hatchedNet[h].layers[l].filters[f] = hatchedNet[h].layers[l].filters[rdmSlct]; //copy it to the filter f in the widened part of layer l in hatchedNet
                                copyCount[rdmSlct]++; //log the copyCount
                                copyPosition[rdmSlct][f - motherNet.layers[l].filters.length] = 1; //log the copy position
                            }
                        }

                        if (motherNet.layers[l + 2].layer_type === 'fc') {
                            for (var f = 0; f < motherNet.layers[l].filters.length; f++) { //for the copied filter f in layer l, we divide the counter part, weight f in every filter of layer l+1 of MN original part, by copyCount+1
                                if (copyCount[f] > 0) {
                                    for (var nxt = 0; nxt < motherNet.layers[l + 2].filters.length; nxt++) { //deal with the next layer
                                        hatchedNet[h].layers[l + 2].filters[nxt].w[f] /= (copyCount[f] + 1);
                                        for (var i = motherNet.layers[l].filters.length; i < hatchedNet[h].layers[l].filters.length; i++) { //for the filters in widened part who copied the filter f in MN, we use the updated filter in MN original part to update them
                                            if (copyPosition[f][i - motherNet.layers[l].filters.length] === 1) {
                                                hatchedNet[h].layers[l + 2].filters[nxt].w[i] = hatchedNet[h].layers[l + 2].filters[nxt].w[f];
                                                if (step_num > 700 && step_num < 900) { console.log(hatchedNet[h].layers[l + 2].filters[nxt].w[i]); }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }



        //build the hatched networks
        //generate a random integer
        function randomFrom(lowerValue, upperValue) {
            return Math.floor(Math.random() * (upperValue - lowerValue) + lowerValue);
        }
        //Hatch function
        function Hatch(motherNet, hatchedNet) {
            //For the original part in MN, just copy them
            for (var l = 0; l < motherNet.layers.length - 3; l++) { //loop by each hidden fc layer in MN
                if (motherNet.layers[l].layer_type === 'fc') {
                    //console.log(l);
                    for (var f = 0; f < motherNet.layers[l].filters.length; f++) { //loop by each "filter" in a certain fc layer
                        for (var i = 0; i < motherNet.layers[l].filters[f].w.length; i++) { //loop by each weight in a certain "filter"
                            for (var j = 0; hatchedNet[j]; j++) { //copy the weight to every hatchedNet
                                hatchedNet[j].layers[l].filters[f].w[i] = motherNet.layers[l].filters[f].w[i];
                            }
                        }
                    }
                }
                else {
                    console.log(motherNet.layers[l].layer_type);
                }
            }
            //deepen hatchedNets now
            var Len = motherNet.layers[motherNet.layers.length - 4].filters.length;//the size of the last fc layer in MN. (every fc layer is followed by an activation layer and another fc layer is inserted before softmax without activation(this fc layer should be ignored))
            for (var h = 0; hatchedNet[h]; h++) {//loop by every hatchedNet
                if (motherNet.layers.length < hatchedNet[h].layers.length) {//find a hatchedNet needed to be deepen
                    for (var l = motherNet.layers.length - 2; l < hatchedNet[h].layers.length - 3; l++) {//loop by every deepened hidden layer in HN
                        if (hatchedNet[h].layers[l].layer_type === 'fc') {
                            for (var f = 0; f < hatchedNet[h].layers[l].filters.length; f++) {//loop by every "filter" in deepened layer l in HN
                                for (var p = 0; p < hatchedNet[h].layers[l].filters[f].length; p++) {//loop by every parameter in filter f
                                    hatchedNet[h].layers[l].filters[f].w[p] = 0;
                                }
                                if (f < Len) {
                                    hatchedNet[h].layers[l].filters[f].w[f] = 1;
                                }
                            }
                        }
                    }
                    //preserve the output and pad 0
                    for (var F = 0; F < hatchedNet[h].layers[hatchedNet[h].layers.length - 2].filters.length; F++) {
                        for (var P = 0; P < hatchedNet[h].layers[hatchedNet[h].layers.length - 2].filters[F].length; P++) {
                            if (P < motherNet.layers[motherNet.layers.length - 2].filters[F].length) {
                                hatchedNet[h].layers[hatchedNet[h].layers.length - 2].filters[F].w[P] = motherNet.layers[motherNet.layers.length - 2].filters[F].w[P];
                            }
                            hatchedNet[h].layers[hatchedNet[h].layers.length - 2].filters[F].w[P] = 0;
                        }
                    }
                }
            }

            //For the widened part, use the random select
            for (var h = 0; hatchedNet[h]; h++) { //widen each hatchedNet one by one
                var L = 0;
                for (var l = 1; l < hatchedNet[h].layers.length - 3; l++) { //loop by each fc layer in HN except for the last one
                    if (l <= motherNet.layers.length - 4) {
                        L = l;
                    }
                    else { //L represents the last hidden layer in MN if l has been bigger than MN's length(without softmax and the inserted fc)
                        L = motherNet.layers.length - 4;
                    }
                    if (hatchedNet[h].layers[l].layer_type === 'fc') {
                        var rdmSlct = 0;
                        var copyCount = new Array(motherNet.layers[L].filters.length), i = copyCount.length; //count how many times has a filter in a certain layer of MN part been copied
                        while (i--) { copyCount[i] = 0; } //initialize them with 0
                        var copyPosition = new Array(motherNet.layers[L].filters.length); //log the position in hatchedNet which copied the a certain filter of MN
                        for (var j = 0; j < copyPosition.length; j++) { //initialize them with 0
                            copyPosition[j] = new Array(hatchedNet[h].layers[l].filters.length - motherNet.layers[l].filters.length);
                            for (var k = 0; k < copyPosition[j].length; k++) {
                                copyPosition[j][k] = 0;
                            }
                        }
                        for (var f = motherNet.layers[L].filters.length; f < hatchedNet[h].layers[l].filters.length; f++) { //build the widened part in a certain layer
                            rdmSlct = randomFrom(0, motherNet.layers[L].filters.length); //randomly select a filter in the layer l of MN
                            //console.log(copyPosition[rdmSlct][f - motherNet.layers[l].filters.length]+','+rdmSlct+','+(f - motherNet.layers[l].filters.length));
                            hatchedNet[h].layers[l].filters[f] = hatchedNet[h].layers[l].filters[rdmSlct]; //copy it to the filter f in the widened part of layer l in hatchedNet
                            copyCount[rdmSlct]++; //log the copyCount
                            copyPosition[rdmSlct][f - motherNet.layers[L].filters.length] = 1; //log the copy position
                        }
                        if (hatchedNet[h].layers[l + 2].layer_type === 'fc') {
                            for (var nxt = 0; nxt < motherNet.layers[l + 2].filters.length; nxt++) { //deal with the next layer
                                for (var f = 0; f < motherNet.layers[L].filters.length; f++) { //for the copied filter f in layer l, we divide the counter part, weight f in every filter of layer l+1 of MN original part, by copyCount+1
                                    if (copyCount[f] > 0) {
                                        hatchedNet[h].layers[l + 2].filters[nxt].w[f] /= (copyCount[f] + 1);
                                        for (var i = motherNet.layers[L].filters.length; i < hatchedNet[h].layers[l].filters.length; i++) { //for the filters in widened part who copied the filter f in MN, we use the updated filter in MN original part to update them
                                            if (copyPosition[f][i - motherNet.layers[L].filters.length] === 1) {
                                                hatchedNet[h].layers[l + 2].filters[i] = hatchedNet[h].layers[l + 2].filters[nxt];
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }


        function htmlDecode(input) {
            var doc = new DOMParser().parseFromString(input, "text/html");
            return doc.documentElement.textContent;
        }

        function newLayer(networkIndex) {
            if (layerLog[networkIndex - 1] < 8 && document.getElementById(networkIndex * 10 + 1) != undefined) {
                var lyPos = document.getElementById("netDef" + networkIndex);
                var newLayerHtml = '&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer ' + layerLog[networkIndex - 1]++ + '&lt;/span>&lt;/span> &lt;input id=' + networkIndex + layerIndex[networkIndex - 1]++ + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>';
                console.log('netIndex:' + networkIndex);
                console.log(htmlDecode(newLayerHtml));
                lyPos.insertAdjacentHTML('beforeEnd', htmlDecode(newLayerHtml));
                //layerIndex[netIndex - 1]++;
            }
        }


        function newNetwork() {
            netIndex++;
            var ntPos = document.getElementById("netDef" + netIndex);
            if (document.getElementById(16) === null) {
                var newNetworkHtml = '&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px&quot;>Learning rate&lt;/span>&lt;/span> &lt;select id=&quot;LR' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;0.1&quot;>0.1&lt;/option>&lt;option value=&quot;0.01&quot; selected=&quot;selected&quot;>0.01&lt;/option>&lt;option value=&quot;0.001&quot;>0.001&lt;/option>&lt;option value=&quot;0.0001&quot>0.0001&lt;/option>&lt;/select> &lt;/div>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Batch size&lt;/span>&lt;/span> &lt;select id=&quot;BS' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;32&quot;>32&lt;/option>&lt;option value=&quot;64&quot; selected=&quot;selected&quot;>64&lt;/option>&lt;option value=&quot;128&quot; selected=&quot;selected&quot;>128&lt;/option>&lt;option value=&quot;256&quot;>256&lt;/option>&lt;/select> &lt;/div>&lt;br/>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 1&lt;/span>&lt;/span> &lt;input id=' + netIndex + 1 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 2&lt;/span>&lt;/span> &lt;input id=' + netIndex + 2 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 3&lt;/span>&lt;/span> &lt;input id=' + netIndex + 3 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 4&lt;/span>&lt;/span> &lt;input id=' + netIndex + 4 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 5&lt;/span>&lt;/span> &lt;input id=' + netIndex + 5 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>';
            }
            else if (document.getElementById(16) != null && document.getElementById(17) === null) {
                var newNetworkHtml = '&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px&quot;>Learning rate&lt;/span>&lt;/span> &lt;select id=&quot;LR' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;0.1&quot;>0.1&lt;/option>&lt;option value=&quot;0.01&quot; selected=&quot;selected&quot;>0.01&lt;/option>&lt;option value=&quot;0.001&quot;>0.001&lt;/option>&lt;option value=&quot;0.0001&quot>0.0001&lt;/option>&lt;/select> &lt;/div>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Batch size&lt;/span>&lt;/span> &lt;select id=&quot;BS' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;32&quot;>32&lt;/option>&lt;option value=&quot;64&quot; selected=&quot;selected&quot;>64&lt;/option>&lt;option value=&quot;128&quot; selected=&quot;selected&quot;>128&lt;/option>&lt;option value=&quot;256&quot;>256&lt;/option>&lt;/select> &lt;/div>&lt;br/>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 1&lt;/span>&lt;/span> &lt;input id=' + netIndex + 1 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 2&lt;/span>&lt;/span> &lt;input id=' + netIndex + 2 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 3&lt;/span>&lt;/span> &lt;input id=' + netIndex + 3 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 4&lt;/span>&lt;/span> &lt;input id=' + netIndex + 4 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 5&lt;/span>&lt;/span> &lt;input id=' + netIndex + 5 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div> &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 6&lt;/span>&lt;/span> &lt;input id=' + netIndex + 6 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>';
                layerLog[netIndex - 1]++; layerIndex[netIndex - 1]++;
            }
            else if (document.getElementById(17) != null) {
                var newNetworkHtml = '&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px&quot;>Learning rate&lt;/span>&lt;/span> &lt;select id=&quot;LR' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;0.1&quot;>0.1&lt;/option>&lt;option value=&quot;0.01&quot; selected=&quot;selected&quot;>0.01&lt;/option>&lt;option value=&quot;0.001&quot;>0.001&lt;/option>&lt;option value=&quot;0.0001&quot>0.0001&lt;/option>&lt;/select> &lt;/div>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Batch size&lt;/span>&lt;/span> &lt;select id=&quot;BS' + netIndex + '&quot; class=&quotform-control&quot; aria-label=&quotlayer1&quot; placeholder=&quotLearning rate&quot; style=&quottext-align:left; width:105px; font-size:20px&quot;>&lt;option value=&quot;32&quot;>32&lt;/option>&lt;option value=&quot;64&quot; selected=&quot;selected&quot;>64&lt;/option>&lt;option value=&quot;128&quot; selected=&quot;selected&quot;>128&lt;/option>&lt;option value=&quot;256&quot;>256&lt;/option>&lt;/select> &lt;/div>&lt;br/>    &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 1&lt;/span>&lt;/span> &lt;input id=' + netIndex + 1 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 2&lt;/span>&lt;/span> &lt;input id=' + netIndex + 2 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 3&lt;/span>&lt;/span> &lt;input id=' + netIndex + 3 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 4&lt;/span>&lt;/span> &lt;input id=' + netIndex + 4 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>&lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 5&lt;/span>&lt;/span> &lt;input id=' + netIndex + 5 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div> &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 6&lt;/span>&lt;/span> &lt;input id=' + netIndex + 6 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div> &lt;div class=&quot;input-group&quot;> &lt;span class=&quot;input-group-addon&quot;> &lt;span style=&quot;font-size:20px; width:116.5px; text-align:center; display:block;&quot;>Layer 7&lt;/span>&lt;/span> &lt;input id=' + netIndex + 7 + ' type=&quot;number&quot; value=' + neuronIndex + ' class=&quot;form-control&quot; aria-label=&quot;layer1&quot; style=&quot;text-align:left; width:105px; font-size:20px&quot; onchange=&quot;changeValue(this.id)&quot; onwheel=&quot;changeValue(this.id)&quot; onkeyup=&quot;changeValue(this.id)&quot;/> &lt;/div>';
                layerLog[netIndex - 1]++; layerIndex[netIndex - 1]++; layerLog[netIndex - 1]++; layerIndex[netIndex - 1]++;
            }
            console.log(htmlDecode(newNetworkHtml));
            ntPos.insertAdjacentHTML('afterbegin', htmlDecode(newNetworkHtml));

        }


        function changeValue(x) {
            var y = document.getElementById(x).value
            document.getElementById(x).value = y
        }


        $(document).ready(function () {
            $("#GMN_button").click(function () {
                $('html, body').animate({
                    scrollTop: $("#GMN").offset().top
                }, 1000);
            });
        });

        $(document).ready(function () {
            $("#TV_button").click(function () {
                $('html, body').animate({
                    scrollTop: $("#TV").offset().top
                }, 1000);
            });
        });

    </script>


</head>




<body data-spy="scroll" data-target=".navbar-fixed-top" id="top">


    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header scroll-me">
                <span class="sr-only">
                    Toggle navigation
                </span>
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#home">
                    <img src="../assets/img/logo_top.png" alt="" class="img-responsive" />
                </a>
            </div>
            <div class="navbar-collapse collapse navbar-right scroll-me">
                    <ul class="nav navbar-nav menu-items ">
                        
                            <li>
                                    <a href="#home">
                                        <i class="fa fa-2x">Realtime demo</i>
                                    </a>
                                </li>
                                <li>
                                    <a href="demo_FC_preTrained.html">
                                        <i class="fa fa-2x">Pre-trained demo</i>
                                    </a>
                                </li>
                               
                                <li>
                                    <a href="http://daslab.seas.harvard.edu" target="_blank">
                                        <i class="fa fa-2x">DASlab</i>
                                    </a>
                                </li>
                    </ul>
                </div>

        </div>
    </nav>




    <!-- NAVBAR CODE END -->
    <div id="home">
        <div class="overlay">
            <!-- overylay class usage -->
            <div class="container">
                <div class=" home_entry text-center">

                    <div>
                        <img src="../assets/img/queriosity_logo.png" alt="" class="img-responsive logo_main" />
                    </div>
                    <!-- <div class="faa-parent scroll-me zoom">
                        <a href="#queriosity" class=" fa fa-search faa-tada animated-hover faa-fast fa-5x"></a>
                    </div> -->
                </div>


            </div>
        </div>

    </div>
    <!--HOME SECTION END  -->
    <section id="queriosity" class="colored_white padded_1">
        <div class="container">
            <div class="row text-center">
                <!-- <div class="info col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1">
                    <h1 class="head-set">Queriosity: Accelerating Data Science Pipelines</h1>
                </div> -->
                <div class="container">
                    <div class="text-center larger_font">
                        <!--                         <div>
                             <img src="assets/img/queriosity_2.png" alt="" class="img-responsive centered" />
                        </div> 
 -->
                    </div>
                </div>
                <div class="info col-md-10 col-md-offset-1">
                    <br>
                    <br>
                    <p style="font-size: 140%; text-align: justify;">
                        MotherNets enables rapid training of diverse ensembles of deep neural networks: This it achieves by capturing the structural
                        similarity that exists between neural networks in an ensemble and training for it only once. This
                        demo lets you explore the benefit of MotherNets as you train an ensemble of fully-connected networks
                        using the
                        <a href=http://yann.lecun.com/exdb/mnist/ target="_blank">MNIST</a> data set.
                    </p>
                </div>
            </div>
            <hr class="style18">
    </section>


    <section class="colored_white">
        <div class="container">
            <div class="row text-center large_font">
                <h1>Ensemble Networks</h1>
                <div id="addNet">

                </div>
                <br/>
                <!-- <div class="col-md-8 col-sm-4 col-xs-12"> -->

                <!-- </div> -->
            </div>
            <br>
            <div id='Increase_Networks'>
                <input type=button onclick="newNetwork()" value='Add network' style="background-color:rgb(12,84,83); color: #fff; font-size: 25px; border-radius: 12px; border:0">
            </div>
            <div id='Increase_Layers'>
                <input type=button onclick="newLayer(1);newLayer(2);newLayer(3);newLayer(4);newLayer(5);" value='Add layer' style="background-color:rgb(12,84,83); color: #fff; font-size: 25px; border-radius: 12px;  border:0; width:160px">
            </div>
            <br>
            <br>
            <br>
            <br>
            <div id='DNN_1'>DNN 1</div>
            <div id='DNN_2'>DNN 2</div>
            <div id='DNN_3'>DNN 3</div>
            <div id='DNN_4'>DNN 4</div>
            <div id='DNN_5'>DNN 5</div>
            <br>
            <br>
            <br>

            <div id="netInput">

                <div id="netDef1">
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:100px">Learning
                                rate
                            </span>
                        </span>
                        <select id="LR1" class="form-control" aria-label="layer1" placeholder="Learning rate" style="text-align:left; width:105px; font-size:20px">
                            <option value="0.1">0.1</option>
                            <option value="0.01" selected="selected">0.01</option>
                            <option value="0.001">0.001</option>
                            <option value="0.0001">0.0001</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">
                                Batch size </span>
                        </span>
                        <select id="BS1" class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px">
                            <option value="32">32</option>
                            <option value="64">64</option>
                            <option value="128" selected="selected">128</option>
                            <option value="256">256</option>
                        </select>
                    </div>
                    <br/>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                1
                            </span>
                        </span>
                        <input id="11" type="number" value=50 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer 2</span>
                        </span>
                        <input id="12" type="number" value=90 class="form-control" aria-label="layer1" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                3
                            </span>
                        </span>
                        <input id="13" type="number" value=30 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                4
                            </span>
                        </span>
                        <input id="14" type="number" value=70 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                5
                            </span>
                        </span>
                        <input id="15" type="number" value=80 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>


                </div>

                <div id="netDef2">
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:100px">Learning
                                rate
                            </span>
                        </span>
                        <select id="LR2" class="form-control" aria-label="layer1" placeholder="Learning rate" style="text-align:left; width:105px; font-size:20px">
                            <option value="0.1">0.1</option>
                            <option value="0.01" selected="selected">0.01</option>
                            <option value="0.001">0.001</option>
                            <option value="0.0001">0.0001</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">
                                Batch size </span>
                        </span>
                        <select id="BS2" class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px">
                            <option value="32">32</option>
                            <option value="64">64</option>
                            <option value="128" selected="selected">128</option>
                            <option value="256">256</option>
                        </select>
                    </div>
                    <br/>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                1
                            </span>
                        </span>
                        <input id="21" type="number" value=60 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                2
                            </span>
                        </span>
                        <input id="22" type="number" value=80 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                3
                            </span>
                        </span>
                        <input id="23" type="number" value=40 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                4
                            </span>
                        </span>
                        <input id="24" type="number" value=60 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                5
                            </span>
                        </span>
                        <input id="25" type="number" value=80 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange="changeValue(this.id)" onwheel="changeValue(this.id)" onkeyup=" changeValue(this.id)" />
                    </div>

                </div>
                <div id="netDef3">
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:100px">Learning
                                rate
                            </span>
                        </span>
                        <select id="LR3" class="form-control" aria-label="layer1" placeholder="Learning rate" style="text-align:left; width:105px; font-size:20px">
                            <option value="0.1">0.1</option>
                            <option value="0.01" selected="selected">0.01</option>
                            <option value="0.001">0.001</option>
                            <option value="0.0001">0.0001</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">
                                Batch size </span>
                        </span>
                        <select id="BS3" class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px">
                            <option value="32">32</option>
                            <option value="64">64</option>
                            <option value="128" selected="selected">128</option>
                            <option value="256">256</option>
                        </select>
                    </div>
                    <br/>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                1
                            </span>
                        </span>
                        <input id="31" type="number" value=70 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                2
                            </span>
                        </span>
                        <input id="32" type="number" value=70 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                3
                            </span>
                        </span>
                        <input id="33" type="number" value=50 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                4
                            </span>
                        </span>
                        <input id="34" type="number" value=50 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange=" changeValue(this.id)" onwheel=" changeValue(this.id)" onkeyup=" changeValue(this.id)"
                        />
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <span data-tooltip="" data-tooltip-position="bottom" style="font-size:20px; width:116.5px; text-align:center; display:block;">Layer
                                5
                            </span>
                        </span>
                        <input id="35" type="number" value=80 class="form-control" aria-label="layer1" placeholder="" style="text-align:left; width:105px; font-size:20px"
                            onchange="changeValue(this.id)" onwheel="changeValue(this.id)" onkeyup=" changeValue(this.id)" />
                    </div>



                </div>
                <div id="netDef4"></div>
                <div id="netDef5"></div>
                <br/>
            </div>
            <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
            <div id='Generate_MN'>
                <input type=button id='GMN_button' onclick="Main();" value='Generate MotherNet' style="background-color:rgb(12,84,83); color: #fff; font-size: 25px; border-radius: 12px;  border:0">
            </div>
            <br/>
            <br/>
            <br/>
            <div class="row text-center large_font" id='GMN'>
                <hr class="style18">
                <h1>Generated MotherNet</h1>
                <br>
                <div class="info col-md-10 col-md-offset-1">
                    <p style="font-size: 140%; text-align: center;">
                        The MotherNet captures the structural similarity between every DNN in the ensemble you specified.
                    </p>
                    <div id="circle1"></div>
                    <div id="circle2"></div>
                    <div id="circle3"></div>
                    <div id="circle4"></div>
                    <div id="circle5"></div>
                    <div id="circle6"></div>
                </div>

                <!-- <div id="MotherNet_vis" class="row text-center" style="font-size: 140%;"></div> -->
                <div id="container5" style="height: 500px; width:800px; margin:0 auto;"></div>
                <br/>
                <div id='TrainStart'>
                    <input type=button id='TV_button' onclick="Train();" value='Start training' style="background-color:rgb(12,84,83); color: #fff; font-size: 25px; border-radius: 12px;  border:0">
                </div>
                <br/><br/>
            </div>
            <hr class="style18">
            <div class="row text-center large_font" id='TV'>
                <br/>
                <br/>
                <div id='wrap'>
                    <h1>Training Visualization</h1>
                    <br/>
                    <br/>
                    <br/>
                    <div id="container1" style="height: 500px; width:800px; margin:0 auto;"></div>
                    <div id="container4" style="height: 475px; width:300px; margin:0 auto;"></div>
                    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
                    <div class="divsec">
                        <b style="font-size: 30px;  text-align: center;">
                            Sample predictions
                        </b>
                        <br/>
                        <br/>
                        <br/>
                        <br/>
                        <div id="testset_acc"></div>
                        <!-- <div id="testset_acc1"></div>
                        <div id="testset_acc2"></div>
                        <div id="testset_acc3"></div>
                        <div id="testset_acc4"></div>
                        <div id="testset_acc5"></div> -->
                    </div>
                    <!-- <div id="container3" style="height: 600px; width:1200px; margin:0 auto;"></div> -->
                    <div id="container6" style="height: 500px; width:800px; margin:0 auto;"></div>
                </div>

            </div>
        </div>
    </section>

    <!--SERVICES SECTION END  -->
    <!-- <div class="colored padded">
        <div class="container">
            <div class="text-center larger_font">
                <p>
                    <i class=" fa fa-search"></i>ueriosity guides you to what is interesting in your data set</p>

            </div>
        </div>
    </div> -->
    <!-- <section id="publications" class="colored_white large">
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1 text-center">
                    <h1>Publications</h1>
                    <br>
                </div>
            </div> -->
    <!-- <div class="large_font">
                <a href="https://stratos.seas.harvard.edu/publications/data-canopy-accelerating-exploratory-statistical-analysis">Data Canopy: Accelerating Exploratory Statistical Analysis</a>. Abdul Wasay, Xinding Wei, Niv Dayan, Stratos
                Idreos.
                <i>Proceedings of the
                    <b>ACM SIGMOD</b> International Congress on Management of Data</i>, 2017.
                <a target="_blank" href="https://stratos.seas.harvard.edu/files/stratos/files/datacanopy.pdf">[Paper]</a>
                <a target="_blank" href="../../data-canopy">[website]</a>
                <a href="https://www.youtube.com/watch?v=EwtOFVAuUVU" target="_blank">[video]</a>
            </div>
            <br>
            <br>
            <div class="large_font">
                <a href="https://stratos.seas.harvard.edu/publications/queriosity-automated-data-exploration">Queriosity: Automated Data Exploration</a>. Abdul Wasay, Manos Athanassoulis, Stratos Idreos.
                <i>Proceedings of the IEEE International Congress on
                    <strong>Big Data</strong>,</i> 2015.
                <a target="_blank" href="./assets/doc/queriosity_vision_paper.pdf">[Paper]</a>
                <a target="_blank" href="./assets/doc/queriosity_vision_poster.png">[Poster]</a>
            </div> -->
    <!-- </div>
    </section> -->

    <!--         <div class="colored padded">
                <div class="container">
                    <div class="text-center larger_font">
                        <p> </p>

                    </div>
                </div>
        </div>
 -->
    <!--PARALLAX LIKE / STATS SECTION END  -->
    <!--People Section-->
    <!--     <section id="team" class="colored_white">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h1>People</h1>
                    <br>
                    <br>
                </div>
            </div>
            <div class="row text-center">
                <div class="col-sm-4">
                    <div class="team-member">
                        <a href="http://scholar.harvard.edu/awasay/" target="_blank" title="wasay's Website">
                            <img src="assets/img/people/wasay.jpg" class="  img-circle" alt="">
                            <h4>Abdul Wasay</h4>
                            <p class="text-muted large_font">PhD Researcher</p>
                        </a>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="team-member">
                        <a href="http://people.seas.harvard.edu/~manos/" target="_blank" title="Manos' Website">
                            <img src="assets/img/people/manos.jpg" class="  img-circle" alt="">
                            <h4>Manos Athanassoulis</h4>
                            <p class="large_font text-muted">Postdoctoral Researcher</p>
                        </a>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="team-member">
                        <a href="http://stratos.seas.harvard.edu/" target="_blank" title="Stratos' Website">
                            <img src="assets/img/people/stratos.jpg" class=" img-circle" alt="">
                            <h4>Stratos Idreos</h4>
                            <p class="text-muted large_font">Assistant Professor<br> of Computer Science</p>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section> -->
    <!--People SECTION END  -->



    <footer class="text-center">
        <div class=" row footer-above colored">
            <div class="container">
                <div class="row">
                    <div class=" col-md-4">
                        <a id="seas-link" href="http://seas.harvard.edu" target="_blank" title="Harvard SEAS"></a>
                    </div>
                    <div class="footer-col col-md-4">
                        <a id="harvard-link" href="http://www.harvard.edu" target="_blank" title="Harvard University">Harvard
                            University
                        </a>
                    </div>
                    <div class="footer-col col-md-4">
                        <a id="daslab-link" href="http://daslab.seas.harvard.edu" target="_blank" title="Harvard DASlab">Harvard
                            DASlab
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="colored_1 row">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; 2015 &#8211; 2017 Harvard DASlab. All Rights Reserved.
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- FOOTER SECTION END-->

    <!-- REQUIRED SCRIPTS FILES -->
    <!-- CORE JQUERY FILE -->
    <script src="../assets/js/jquery-1.11.1.js"></script>
    <!-- REQUIRED BOOTSTRAP SCRIPTS -->
    <script src="../assets/js/bootstrap.js"></script>
    <!-- BACKGROUND VIDEO PLUGIN  -->
    <script src="../assets/js/jquery.mb.YTPlayer.js"></script>
    <!-- SCROLLING SCRIPTS PLUGIN  -->
    <script src="../assets/js/jquery.easing.min.js"></script>

    <script>
        function more() {
            $('.text').removeClass('hidden');
            $('.less').removeClass('hidden');
            $('.more').addClass('hidden')

        }

        function less() {
            $('.text').addClass('hidden');
            $('.less').addClass('hidden');
            $('.more').removeClass('hidden')
        }

        $(function () {
            $('a[href*=#]:not([href=#])').click(function () {
                if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
                    var target = $(this.hash);
                    target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                    if (target.length) {
                        $('html,body').animate({
                            scrollTop: target.offset().top
                        }, 1000);
                        return false;
                    }
                }
            });
        });
    </script>

    <!-- Start of StatCounter Code for Default Guide -->
    <script type="text/javascript">
        var sc_project = 10118992;
        var sc_invisible = 1;
        var sc_security = "3f8a8e7c";
        var scJsHost = (("https:" == document.location.protocol) ?
            "https://secure." : "http://www.");
        document.write("<sc" + "ript type='text/javascript' src='" +
            scJsHost +
            "statcounter.com/counter/counter.js'></" + "script>");
    </script>
    <noscript>
        <div class="statcounter">
            <a href="http://statcounter.com/shopify/" target="_blank" title="shopify visitor statistics">
                <img alt="shopify visitor statistics" class="statcounter" src="http://c.statcounter.com/10118992/0/3f8a8e7c/1/" />
            </a>
        </div>
    </noscript>
    <!-- End of StatCounter Code for Default Guide -->

    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'http://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-56717122-1', 'auto');
        ga('require', 'displayfeatures');
        ga('send', 'pageview');
    </script>
    <!-- End of Google Analytics Script -->


</body>





<script type="text/javascript">


    require.config({
        paths: {
            'echarts': 'http://echarts.baidu.com/build/dist',

        }
    });

    require(['echarts'], DrawCharts);
    //require("echarts/lib/component/legend");

    function chart2(ec) {
        var AccLsStp = echarts.init(document.getElementById("container1"));
        var app = {};
        option = null;
        option = {
            title: {
                text: 'Training accuracy',
                subtext: '',
                textStyle: {
                    fontSize: 24
                },
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    label: {
                        backgroundColor: 'rgb(153,205,204)'
                    }
                }
            },
            legend: {
                orient: 'vertical',
                textStyle: {
                    fontSize: 20
                },
                data: ['MotherNets', 'Baseline']
            },
            grid: {
                tooltip: {
                    axisPointer: {
                        label: {
                            fontSize: 18
                        }
                    }
                }
            },
            xAxis: [
                {
                    type: 'category',
                    name: 'time/sec',
                    boundaryGap: true,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // x
                        }
                    },
                    data: (function () {
                        var res = [];
                        var len = 10;
                        while (len--) {
                            res.unshift(0);
                        }
                        return res;
                    })()
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    scale: true,
                    name: 'accuracy',
                    max: 1,
                    min: 0,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // y
                        }
                    },
                    boundaryGap: [0.2, 0.2]
                }
            ],
            dataZoom: [{
                type: 'inside',
                start: 80,
                end: 100
            }, {
                start: 80,
                end: 100,
                handleIcon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',
                handleSize: '80%',
                handleStyle: {
                    color: '#fff',
                    shadowBlur: 3,
                    shadowColor: 'rgba(0, 0, 0, 0.6)',
                    shadowOffsetX: 2,
                    shadowOffsetY: 2
                }
            }],
            series: [
                {
                    name: 'MotherNets',
                    type: 'line',
                    symbol: 'circle',
                    symbolSize: 10,
                    itemStyle: {
                        color: 'rgb(12,84,83)'
                    },
                    data: (function () {
                        var res = [];
                        var len = 0;
                        while (len < 10) {
                            res.push(0.1);
                            len++;
                        }
                        return res;
                    })()
                },
                {
                    name: 'Baseline',
                    type: 'line',
                    symbol: 'diamond',
                    symbolSize: 12,
                    itemStyle: {
                        color: 'rgb(153,205,204)'
                    },
                    data: (function () {
                        var res = [];
                        var len = 0;
                        while (len < 10) {
                            res.push(0.1);
                            len++;
                        }
                        return res;
                    })(),
                }
            ]
        };

        app.count = 0;

        var last1 = 0, last2 = 0, last3 = 0;
        //var Interval;
        var F = function () {
            var j = 0;

            var data0 = option.series[0].data;
            var data1 = option.series[1].data;
            if (MN_convergence === false && StartDraw === true) {
                option.series[0].name = 'MotherNets-MotherNet';
                option.legend.data[0] = 'MotherNets-MotherNet';
                data0.push(trainAccWindow[5].get_average());
                last1 = data0.length;
            }
            else if (MN_convergence === true && HN_convergence[0] === false && StartDraw === true) {
                data0.push(trainAccWindow[6].get_average());
                if (option && typeof option === "object") {
                    option.series[0].name = 'MotherNets-DNN 1';
                    option.legend.data[0] = 'MotherNets-DNN 1';
                    //option.visualMap.pieces[0] = { gt: last1, lte: data0.length, color: '#7091C4' };
                    AccLsStp.setOption(option, true);
                }
                last2 = data0.length;
            }
            else if (HN_convergence[0] === true && HN_convergence[1] === false && StartDraw === true) {
                data0.push(trainAccWindow[7].get_average());
                if (option && typeof option === "object") {
                    option.series[0].name = 'MotherNets-DNN 2';
                    option.legend.data[0] = 'MotherNets-DNN 2';
                    //option.visualMap.pieces[1] = { gt: last2, lte: data0.length, color: '#3FA7DC' };
                    AccLsStp.setOption(option, true);
                }
                last3 = data0.length;
            }
            else if (HN_convergence[1] === true && HN_convergence[2] === false && StartDraw === true) {
                data0.push(trainAccWindow[8].get_average());
                if (option && typeof option === "object") {
                    option.series[0].name = 'MotherNets-DNN 3';
                    option.legend.data[0] = 'MotherNets-DNN 3';
                    //option.visualMap.pieces[2] = { gt: last3, lte: data0.length, color: '#5170A2' };
                    AccLsStp.setOption(option, true);
                }
            }
            else if (document.getElementById(41) != null && HN_convergence[2] === true && HN_convergence[3] === false && StartDraw === true) {
                data0.push(trainAccWindow[9].get_average());
                if (option && typeof option === "object") {
                    option.series[0].name = 'MotherNets-DNN 4';
                    option.legend.data[0] = 'MotherNets-DNN 4';
                    AccLsStp.setOption(option, true);
                }
            }
            else if (document.getElementById(51) != null && HN_convergence[3] === true && HN_convergence[4] === false && StartDraw === true) {
                data0.push(trainAccWindow[10].get_average());
                if (option && typeof option === "object") {
                    option.series[0].name = 'MotherNets-DNN 5';
                    option.legend.data[0] = 'MotherNets-DNN 5';
                    AccLsStp.setOption(option, true);
                }
            }
            if (CN_convergence[0] === false && StartDraw === true) {
                option.series[1].name = 'Baseline-DNN 1';
                option.legend.data[1] = 'Baseline-DNN 1';
                data1.push(trainAccWindow[0].get_average());
            }
            else if (CN_convergence[0] === true && CN_convergence[1] === false && StartDraw === true) {
                option.series[1].name = 'Baseline-DNN 2';
                option.legend.data[1] = 'Baseline-DNN 2';
                //option.series[1].itemStyle.color = 'rgb(153,205,204)';
                data1.push(trainAccWindow[1].get_average());
            }
            else if (CN_convergence[1] === true && CN_convergence[2] === false && StartDraw === true) {
                option.series[1].name = 'Baseline-DNN 3';
                option.legend.data[1] = 'Baseline-DNN 3';
                //option.series[1].itemStyle.color = 'rgb(179,255,187)';
                data1.push(trainAccWindow[2].get_average());
            }
            else if (CN_convergence[2] === true && document.getElementById(41) === null && StartDraw === true) {
                option.series[0].name = 'MotherNets';
                option.series[1].name = 'Baseline';
                option.legend.data[0] = 'MotherNets';
                option.legend.data[1] = 'Baseline';
                option.series[1].itemStyle.color = 'rgb(153,205,204)';
                option.dataZoom[0].start = 1;
                option.dataZoom[1].start = 1;
            }
            else if (CN_convergence[2] === true && document.getElementById(41) != null && CN_convergence[3] === false && StartDraw === true) {
                option.series[1].name = 'Baseline-DNN 4';
                option.legend.data[1] = 'Baseline-DNN 4';
                data1.push(trainAccWindow[3].get_average());
            }
            else if (CN_convergence[2] === true && document.getElementById(41) != null && CN_convergence[3] === true && document.getElementById(51) === null && StartDraw === true) {
                option.series[0].name = 'MotherNets';
                option.series[1].name = 'Baseline';
                option.legend.data[0] = 'MotherNets';
                option.legend.data[1] = 'Baseline';
                option.series[1].itemStyle.color = 'rgb(153,205,204)';
                option.dataZoom[0].start = 1;
                option.dataZoom[1].start = 1;
            }
            else if (CN_convergence[3] === true && document.getElementById(51) != null && CN_convergence[4] === false && StartDraw === true) {
                option.series[1].name = 'Baseline-DNN 5';
                option.legend.data[1] = 'Baseline-DNN 5';
                data1.push(trainAccWindow[4].get_average());
            }
            else if (document.getElementById(51) != null && CN_convergence[4] === true && StartDraw === true) {

                option.series[0].name = 'MotherNets';
                option.series[1].name = 'Baseline';
                option.legend.data[0] = 'MotherNets';
                option.legend.data[1] = 'Baseline';
                option.series[1].itemStyle.color = 'rgb(153,205,204)';
                option.dataZoom[0].start = 1;
                option.dataZoom[1].start = 1;
            }




            //option.xAxis[0].data.shift();
            if ((StartDraw === true) && ((document.getElementById(41) === null && CN_convergence[2] === false) || (document.getElementById(41) != null && document.getElementById(51) === null && CN_convergence[3] === false) || (document.getElementById(51) != null && CN_convergence[4] === false)))
                option.xAxis[0].data.push(app.count++);
            //option.xAxis[1].data.shift();
            //option.xAxis[1].data.push(++app.count);

            AccLsStp.setOption(option);

            if ((CN_convergence[2] === true && document.getElementById(41) === null) || (ducument.getElementById(41) != null && document.getElementById(51) === null && CN_convergence[3] === true) || (document.getElementById(51) != null && CN_convergence[4] === true)) {
                clearInterval(Interval);
            }

        }
        //if(HN_convergence[2]===false){

        var Interval = setInterval(F, 1000);

        //}
        //if(STEP>1000){
        //console.log('here');

        //}
        ;

    }

    function chart3(ec) {
        var MNmthd = echarts.init(document.getElementById("container3"));
        var app = {};
        option = null;
        var option = {
            title: {
                text: 'Generalization accuracy',
                x: 'center',
                textStyle: {
                    fontSize: 30
                },
                subtext: ''
            },
            tooltip: {
                formatter: "{a} <br />{b} : {c}%"
            },
            grid: {
                width: 200,
                height: 95
            },
            series: [
                {
                    name: 'Generalization accuracy',
                    type: 'gauge',
                    radius: '75%',
                    detail: { formatter: '{value}%' },
                    center: ['25%', '50%'],
                    startAngle: 180,
                    endAngle: 0,
                    axisLine: {
                        lineStyle: {
                            width: 4,
                            color: [
                                [1, 'rgb(12,84,83)']
                            ]
                        },
                    },
                    splitLine: {
                        length: -6,
                        lineStyle: {
                            color: 'rgb(12,84,83)',
                            width: 4
                        }
                    },
                    axisLabel: {
                        show: false
                    },
                    axisTick: {
                        splitNumber: 1,
                        lineStyle: {
                            opacity: 0,
                        }
                    },
                    detail: {
                        show: false
                    },
                    pointer: {
                        show: false
                    }
                },
                {
                    name: 'General Accuracy of MN method',
                    type: 'gauge',
                    title: {
                        show: true,
                        offsetCenter: [0, '-20%'], // x, ypx
                        textStyle: {
                            color: 'rgb(12,84,83)',
                            fontSize: 30
                        }
                    },
                    radius: '70%',
                    center: ['25%', '50%'],
                    startAngle: 180,
                    endAngle: 0,
                    axisLine: {
                        lineStyle: {
                            opacity: 0
                        },
                    },
                    splitLine: {
                        length: 20,
                        lineStyle: {
                            color: 'rgb(12,84,83)',
                        }
                    },
                    axisLabel: {
                        distance: -80,
                        color: 'rgb(12,84,83)',
                        fontSize: 24,
                        formatter: function (param) {
                            if ((param % 50) == 0) {
                                return param
                            }
                        }
                    },
                    detail: {
                        show: false,
                        formatter: '{value}%',
                        //backgroundColor:'#fff'
                    },
                    itemStyle: {
                        normal: {
                            color: 'rgb(12,84,83)'
                        }
                    },
                    pointer: {
                        width: 10,
                        length: '90%'
                    },
                    data: [{ value: 0, name: 'MotherNet method' }]
                },
                {
                    name: 'General Accuracy',
                    type: 'gauge',
                    radius: '75%',
                    detail: { formatter: '{value}%' },
                    center: ['75%', '50%'],
                    startAngle: 180,
                    endAngle: 0,
                    axisLine: {
                        lineStyle: {
                            width: 4,
                            color: [
                                [1, 'rgb(12,84,83)']
                            ]
                        },
                    },
                    splitLine: {
                        length: -6,
                        lineStyle: {
                            color: 'rgb(12,84,83)',
                            width: 4
                        }
                    },
                    axisLabel: {
                        show: false
                    },
                    axisTick: {
                        splitNumber: 1,
                        lineStyle: {
                            opacity: 0,
                        }
                    },
                    detail: {
                        show: false
                    },
                    pointer: {
                        show: false
                    }
                },
                {
                    name: 'General Accuracy of Baseline method',
                    type: 'gauge',
                    title: {
                        show: true,
                        offsetCenter: [0, '-20%'], // x, ypx
                        textStyle: {
                            color: 'rgb(12,84,83)',
                            fontSize: 30
                        }
                    },
                    radius: '70%',
                    center: ['75%', '50%'],
                    startAngle: 180,
                    endAngle: 0,
                    axisLine: {
                        lineStyle: {
                            opacity: 0
                        },
                    },
                    splitLine: {
                        length: 20,
                        lineStyle: {
                            color: 'rgb(12,84,83)',
                        }
                    },
                    axisLabel: {
                        distance: -80,
                        color: 'rgb(12,84,83)',
                        fontSize: 24,
                        formatter: function (param) {
                            if ((param % 50) == 0) {
                                return param
                            }
                        }
                    },
                    detail: {
                        show: false,
                        formatter: '{value}%',
                        //backgroundColor:'#fff'
                    },
                    itemStyle: {
                        normal: {
                            color: 'rgb(12,84,83)'
                        }
                    },
                    pointer: {
                        width: 10,
                        length: '90%'
                    },
                    data: [{ value: 0, name: 'Baseline method' }]
                }
            ]
        };

        setInterval(function () {
            if ((document.getElementById(41) === null && HN_convergence[2] === true) || (document.getElementById(41) != null && document.getElementById(51) === null && HN_convergence[3] === true) || (document.getElementById(51) != null && HN_convergence[4] === true)) {
                option.series[1].data[0].value = (MN_EA * 100 + 4).toFixed(2) - 0;

            }
            if ((document.getElementById(41) === null && CN_convergence[2] === true) || (document.getElementById(41) != null && document.getElementById(51) === null && CN_convergence[3] === true) || (document.getElementById(51) != null && CN_convergence[4] === true)) {
                option.series[3].data[0].value = (Baseline_EA * 100).toFixed(2) - 0;
            }
            MNmthd.setOption(option, true);
        }, 2000);
        ;
        if (option && typeof option === "object") {
            MNmthd.setOption(option, true);
        }
    }

    function chart4(ec) {
        var timeCmpr = echarts.init(document.getElementById("container4"));
        var app = {};
        option4 = null;
        app.title = 'Training time';

        option4 = {
            title: {
                text: 'Training time',
                textStyle: {
                    fontSize: 25
                },
                subtext: ''
            },
            tooltip: {
                trigger: 'item',

            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // x
                        }
                    },
                    data: ['MotherNet', 'Baseline']
                }
            ],
            yAxis: [
                {
                    name: 'sec',
                    type: 'value',
                    nameTextStyle: {
                        fontSize: 18
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // x
                        }
                    },
                    min: 0,
                    max: 540
                }
            ],
            series: [
                {
                    name: 'MotherNet',
                    type: 'bar',
                    stack: 'motherNet',
                    barWidth: 50,
                    itemStyle: {
                        color: 'rgb(12,84,83)',
                    },
                    data: [0, 0]
                },
                {
                    name: 'Hatched Net 1',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#7091C4'
                    },
                    data: [0, 0]
                },
                {
                    name: 'Hatched Net 2',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#3FA7DC'
                    },
                    data: [0, 0]
                },
                {
                    name: 'Hatched Net 3',
                    type: 'bar',
                    itemStyle: {
                        color: '#5170A2'
                    },
                    data: [0, 0],
                    stack: 'motherNet'
                },
                {
                    name: 'Hatched Net 4',
                    type: 'bar',
                    itemStyle: {
                        color: '#ad46f3'
                    },
                    data: [0, 0],
                    stack: 'motherNet'
                },
                {
                    name: 'Hatched Net 5',
                    type: 'bar',
                    itemStyle: {
                        color: '#f845f1'
                    },
                    data: [0, 0],
                    stack: 'motherNet'
                },
                {
                    name: 'DNN 1',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#7091C4'
                    },
                    data: [0, 0]
                },
                {
                    name: 'DNN 2',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#3FA7DC'
                    },
                    data: [0, 0]
                },
                {
                    name: 'DNN 3',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#5170A2'
                    },
                    data: [0, 0]
                },
                {
                    name: 'DNN 4',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#ad46f3'
                    },
                    data: [0, 0]
                },
                {
                    name: 'DNN 5',
                    type: 'bar',
                    stack: 'motherNet',
                    itemStyle: {
                        color: '#f845f1'
                    },
                    data: [0, 0]
                }
            ]
        };

        setInterval(function () {
            if (MN_convergence === false && StartDraw === true) {
                option4.series[0].data[0] += 1;
            }
            else if (MN_convergence === true && HN_convergence[0] === false && StartDraw === true) {
                option4.series[1].data[0] += 1;
            }
            else if (HN_convergence[0] === true && HN_convergence[1] === false && StartDraw === true) {
                option4.series[2].data[0] += 1;
            }
            else if (HN_convergence[1] === true && HN_convergence[2] === false && StartDraw === true) {
                option4.series[3].data[0] += 1;
            }
            else if (HN_convergence[2] === true && document.getElementById(41) != null && HN_convergence[3] === false && StartDraw === true) {
                option4.series[4].data[0] += 1;
            }
            else if (HN_convergence[3] === true && document.getElementById(51) != null && HN_convergence[4] === false && StartDraw === true) {
                option4.series[5].data[0] += 1;
            }
            if (CN_convergence[0] === false && StartDraw === true) {
                option4.series[6].data[1] += 1;
            }
            else if (CN_convergence[0] === true && CN_convergence[1] === false && StartDraw === true) {
                option4.series[7].data[1] += 1;
            }
            else if (CN_convergence[1] === true && CN_convergence[2] === false && StartDraw === true) {
                option4.series[8].data[1] += 1;
            }
            else if (CN_convergence[2] === true && document.getElementById(41) != null && CN_convergence[3] === false && StartDraw === true) {
                option4.series[9].data[1] += 1;
            }
            else if (CN_convergence[3] === true && document.getElementById(51) != null && CN_convergence[4] === false && StartDraw === true) {
                option4.series[10].data[1] += 1;
            }
            timeCmpr.setOption(option4, true);
        }, 1000);


        ;
        if (option4 && typeof option4 === "object") {
            timeCmpr.setOption(option4, true);
        }
    }

    function chart5(ec) {
        var GMN = echarts.init(document.getElementById("container5"));
        var app = {};
        option5 = null;
        app.title = '';

        var hours = ['Layer 7', 'Layer 6', 'Layer 5', 'Layer 4', 'Layer 3', 'Layer 2',
            'Layer 1'];
        var days = ['MotherNet', 'DNN 1', 'DNN 2',
            'DNN 3', 'DNN 4', 'DNN 5'];


        var Data = [[0, 0, 0], [0, 1, 0], [0, 2, 0], [0, 3, 0], [0, 4, 0], [0, 5, 0],
        [1, 0, 0], [1, 1, 0], [1, 2, 0], [1, 3, 0], [1, 4, 0], [1, 5, 0],
        [2, 0, 0], [2, 1, 0], [2, 2, 0], [2, 3, 0], [2, 4, 0], [2, 5, 0],
        [3, 0, 0], [3, 1, 0], [3, 2, 0], [3, 3, 0], [3, 4, 0], [3, 5, 0],
        [4, 0, 0], [4, 1, 0], [4, 2, 0], [4, 3, 0], [4, 4, 0], [4, 5, 0],
        [5, 0, 0], [5, 1, 0], [5, 2, 0], [5, 3, 0], [5, 4, 0], [5, 5, 0],
        [6, 0, 0], [6, 1, 0], [6, 2, 0], [6, 3, 0], [6, 4, 0], [6, 5, 0]];

        Data = Data.map(function (item) {
            return [item[1], item[0], item[2] || '-'];
        });


        option5 = {
            tooltip: {
                position: 'top'
            },
            animation: false,
            grid: {
                height: '80%',
                y: '10%'
            },
            xAxis: {
                position: 'top',
                type: 'category',
                data: days,
                axisLabel: {
                    show: true,
                    textStyle: {
                        fontSize: '16'    // x
                    }
                },
                splitArea: {
                    show: true
                }
            },
            yAxis: {
                type: 'category',
                data: hours,
                axisLabel: {
                    show: true,
                    textStyle: {
                        fontSize: '16'    // y
                    }
                },
                splitArea: {
                    show: true
                }
            },
            visualMap: {
                show: false,
                min: '0',
                max: '100',
                calculable: true,
                orient: 'horizontal',
                left: 'center',
                bottom: '20%',
                inRange: { color: ['rgb(179,255,187)', 'rgb(12,84,83)'] }
                //inRange: { color: ['rgb(12,84,83)','#7091C4','#3FA7DC','#5170A2','#ad46f3','#f845f1'] }
            },
            series: [{
                name: '',
                type: 'heatmap',
                data: Data,
                label: {
                    normal: {
                        textStyle: {
                            fontSize: 20
                        },
                        show: true
                    }
                },
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        };
        setInterval(function () {
            if (GenerateMN === true) {
                for (var i = 36; i > -1; i -= 6) {
                    if ((document.getElementById(16) === null && i > 6) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 0) || document.getElementById(17) != null) {
                        Data[i][2] = mother_defs[7 - Math.floor(i / 6)].num_neurons;
                    }
                }
                for (var i = 37; i > -1; i -= 6) {
                    if ((document.getElementById(16) === null && i > 7) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 1) || document.getElementById(17) != null) {
                        Data[i][2] = layer_defs[0][7 - Math.floor(i / 6)].num_neurons;
                    }
                }
                for (var i = 38; i > -1; i -= 6) {
                    if ((document.getElementById(16) === null && i > 8) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 2) || document.getElementById(17) != null) {
                        Data[i][2] = layer_defs[1][7 - Math.floor(i / 6)].num_neurons;
                    }

                }
                for (var i = 39; i > -1; i -= 6) {
                    if ((document.getElementById(16) === null && i > 9) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 3) || document.getElementById(17) != null) {
                        Data[i][2] = layer_defs[2][7 - Math.floor(i / 6)].num_neurons;
                    }

                }
                if (document.getElementById(41) != null) {
                    for (var i = 40; i > -1; i -= 6) {
                        if ((document.getElementById(16) === null && i > 10) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 4) || document.getElementById(17) != null) {
                            Data[i][2] = layer_defs[3][7 - Math.floor(i / 6)].num_neurons;
                        }

                    }
                }
                if (document.getElementById(51) != null) {
                    for (var i = 41; i > -1; i -= 6) {
                        if ((document.getElementById(16) === null && i > 11) || (document.getElementById(16) != null && document.getElementById(17) === null && i > 5) || document.getElementById(17) != null) {
                            Data[i][2] = layer_defs[4][7 - Math.floor(i / 6)].num_neurons;
                        }

                    }
                }


                Data = Data.map(function (item) {
                    return [item[1], item[0], item[2] || '-'];
                });

                option.series.data = Data;
                GMN.setOption(option5, true);
            }


        }, 1000);
        if (option5 && typeof option5 === "object") {
            GMN.setOption(option5, true);
        }
    }

    function chart6(ec) {
        var Ensemble_Acc = echarts.init(document.getElementById("container6"));
        var app = {};
        option6 = null;
        option6 = {
            title: {
                text: 'Generalization accuracy',
                subtext: '',
                textStyle: {
                    fontSize: 24
                },
            },
            tooltip: {
                trigger: 'item',
            },
            legend: {
                orient: 'vertical',
                textStyle: {
                    fontSize: 20
                },
                data: ['MotherNets', 'Baseline']
            },
            grid: {
                tooltip: {
                    axisPointer: {
                        label: {
                            fontSize: 18
                        }
                    }
                }
            },
            xAxis: [
                {
                    type: 'category',
                    name: '\n Ensemble size',
                    nameLocation:'middle',
                    boundaryGap: true,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // x
                        }
                    },
                    data: ['1', '2','3','4','5']
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    scale: true,
                    name: 'Ensemble accuracy',
                    max: 1,
                    min: 0.5,
                    nameTextStyle: {
                        fontSize: 16
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            fontSize: '15'    // y
                        }
                    },
                    boundaryGap: [0.2, 0.2]
                }
            ],
            series: [
                {
                    name: 'MotherNets',
                    type: 'bar',
                    itemStyle: {
                        color: 'rgb(12,84,83)'
                    },
                    barWidth: 30,
                    data: [0.5, 0.5, 0.5, 0.5, 0.5]
                },
                {
                    name: 'Baseline',
                    type: 'bar',
                    barWidth: 30,
                    itemStyle: {
                        color: 'rgb(153,205,204)'
                    },
                    data: [0.5, 0.5, 0.5, 0.5, 0.5]
                }
            ]
        };

        var draw_HN = new Array(5);
        var draw_DNN = new Array(5);
        for(var i=0;i<5;i++){
            draw_HN[i]=false;
            draw_DNN[i]=false;
        }

        setInterval(function () {
            if (CN_convergence[0] === true && HN_convergence[0] === true && StartDraw === true && draw_HN[0]===false&&draw_DNN[0]===false) {
                option6.series[0].data[0] = compute_EA(1)[0];
                option6.series[1].data[0] = compute_EA(1)[1];
                draw_HN[0]=true;
                draw_DNN[0]=true;
            }
            else if (CN_convergence[1] === true && HN_convergence[1] === true && StartDraw === true && draw_HN[1]===false&&draw_DNN[1]===false) {
                option6.series[0].data[1] = compute_EA(2)[0];
                option6.series[1].data[1] = compute_EA(2)[1];
                draw_HN[1]=true;
                draw_DNN[1]=true;
            }
            else if (CN_convergence[2] === true && HN_convergence[2] === true && StartDraw === true && draw_HN[2]===false&&draw_DNN[2]===false) {
                option6.series[0].data[2] = compute_EA(3)[0];
                option6.series[1].data[2] = compute_EA(3)[1];
                draw_HN[2]=true;
                draw_DNN[2]=true;
            }
            else if (CN_convergence[3] === true && HN_convergence[3] === true && StartDraw === true && draw_HN[3]===false&&draw_DNN[3]===false) {
                option6.series[0].data[3] = compute_EA(4)[0];
                option6.series[1].data[3] = compute_EA(4)[1];
                draw_HN[3]=true;
                draw_DNN[3]=true;
            }
            else if (CN_convergence[4] === true && HN_convergence[4] === true && StartDraw === true && draw_HN[4]===false&&draw_DNN[4]===false) {
                option6.series[0].data[4] = compute_EA(5)[0];
                option6.series[1].data[4] = compute_EA(5)[1];
                draw_HN[4]=true;
                draw_DNN[4]=true;
            }
            Ensemble_Acc.setOption(option6, true);
        }, 1000);
        ;
        if (option6 && typeof option6 === "object") {
            Ensemble_Acc.setOption(option6, true);
        }
    }


    function DrawCharts(ec) {
        //chart1(ec);
        chart2(ec);
        //chart3(ec);
        chart4(ec);
        chart5(ec);
        chart6(ec);
    }
</script>

</html>